/*
 almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/almond for details
 RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/text for details
 Copyright 2012 Martijn van de Rijdt & Modi Labs

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 Copyright 2012 Silvio Moreto, Martijn van de Rijdt & Modilabs

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 Copyright 2012 Martijn van de Rijdt & Modilabs

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 Copyright 2012 Silvio Moreto, Martijn van de Rijdt & Modilabs

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 Copyright 2013 Martijn van de Rijdt & Modi Labs

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 Copyright 2012 Martijn van de Rijdt & Modi Labs

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 Copyright 2012 Martijn van de Rijdt & Modi Labs

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 Copyright 2012 Martijn van de Rijdt & Modi Labs

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 Copyright 2012 Martijn van de Rijdt & Modi Labs

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
   (C)2014
*/
var requirejs,require,define;
(function(f){function p(e,b){var q,a,n,t,d,f,h,r,k,g=b&&b.split("/"),m=l.map,p=m&&m["*"]||{};if(e&&"."===e.charAt(0))if(b){e=e.split("/");d=e.length-1;l.nodeIdCompat&&A.test(e[d])&&(e[d]=e[d].replace(A,""));e=g.slice(0,g.length-1).concat(e);for(d=0;d<e.length;d+=1)if(q=e[d],"."===q)e.splice(d,1),--d;else if(".."===q)if(1!==d||".."!==e[2]&&".."!==e[0])0<d&&(e.splice(d-1,2),d-=2);else break;e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((g||p)&&m){q=e.split("/");for(d=q.length;0<d;--d){a=
q.slice(0,d).join("/");if(g)for(k=g.length;0<k;--k)if(n=m[g.slice(0,k).join("/")])if(n=n[a]){t=n;f=d;break}if(t)break;!h&&p&&p[a]&&(h=p[a],r=d)}!t&&h&&(t=h,f=r);t&&(q.splice(0,f,t),e=q.join("/"))}return e}function k(e,b){return function(){var a=q.call(arguments,0);"string"!==typeof a[0]&&1===a.length&&a.push(null);return n.apply(f,a.concat([e,b]))}}function g(e){return function(b){return p(b,e)}}function d(e){return function(b){v[e]=b}}function a(q){if(e.call(w,q)){var a=w[q];delete w[q];t[q]=!0;
b.apply(f,a)}if(!e.call(v,q)&&!e.call(t,q))throw Error("No "+q);return v[q]}function h(e){var b,q=e?e.indexOf("!"):-1;-1<q&&(b=e.substring(0,q),e=e.substring(q+1,e.length));return[b,e]}function m(e){return function(){return l&&l.config&&l.config[e]||{}}}var b,n,r,u,v={},w={},l={},t={},e=Object.prototype.hasOwnProperty,q=[].slice,A=/\.js$/;r=function(e,b){var q,l=h(e),n=l[0];e=l[1];n&&(n=p(n,b),q=a(n));n?e=q&&q.normalize?q.normalize(e,g(b)):p(e,b):(e=p(e,b),l=h(e),n=l[0],e=l[1],n&&(q=a(n)));return{f:n?
n+"!"+e:e,n:e,pr:n,p:q}};u={require:function(e){return k(e)},exports:function(e){var b=v[e];return"undefined"!==typeof b?b:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:m(e)}}};b=function(b,q,l,n){var A,h,g,m,p=[];h=typeof l;var K;n=n||b;if("undefined"===h||"function"===h){q=!q.length&&l.length?["require","exports","module"]:q;for(m=0;m<q.length;m+=1)if(g=r(q[m],n),h=g.f,"require"===h)p[m]=u.require(b);else if("exports"===h)p[m]=u.exports(b),K=!0;else if("module"===h)A=p[m]=u.module(b);
else if(e.call(v,h)||e.call(w,h)||e.call(t,h))p[m]=a(h);else if(g.p)g.p.load(g.n,k(n,!0),d(h),{}),p[m]=v[h];else throw Error(b+" missing "+h);q=l?l.apply(v[b],p):void 0;b&&(A&&A.exports!==f&&A.exports!==v[b]?v[b]=A.exports:q===f&&K||(v[b]=q))}else b&&(v[b]=l)};requirejs=require=n=function(e,q,A,t,d){if("string"===typeof e)return u[e]?u[e](q):a(r(e,q).f);if(!e.splice){l=e;l.deps&&n(l.deps,l.callback);if(!q)return;q.splice?(e=q,q=A,A=null):e=f}q=q||function(){};"function"===typeof A&&(A=t,t=d);t?b(f,
e,q,A):setTimeout(function(){b(f,e,q,A)},4);return n};n.config=function(e){return n(e)};requirejs._defined=v;define=function(q,b,l){if("string"!==typeof q)throw Error("See almond README: incorrect module build, no module name");b.splice||(l=b,b=[]);e.call(v,q)||e.call(w,q)||(w[q]=[q,b,l])};define.amd={jQuery:!0}})();define("../../lib/almond",function(){});
(function(f,p){"function"===typeof define&&define.amd?define("merge-xml",[],p):"object"===typeof exports?module.exports=p():f.MergeXML=p()})(this,function(){return function(f){var p,k,g,d,a,h,m,b,n,r=this;r.Init=function(){r.dom=null;r.nsp={};r.count=0;b[1]=!1;0<p&&(r.error={code:"",text:""});return 0<p};r.AddFile=function(q){return q&&q.target?q.target.result?r.AddSource(q.target.result):e("emf"):e("nof")};r.AddSource=function(q){var a;if("object"===typeof q)(a=r.Get(1,q)?q:!1)&&(1===p&&!window.DOMParser||
2===p&&!a.selectSingleNode("/"))&&(a=null);else try{a=u(q)}catch(d){a=!1}if(null===a)a=e("nos");else if(!1===a)a=e("inv");else if(!0===a)r.nsp=w(r.dom.documentElement),r.count=1,a=r.dom;else{var f=a;q=!0;if(f.inputEncoding!==r.dom.inputEncoding||f.xmlEncoding!==r.dom.xmlEncoding)q=e("enc");else if(f.documentElement.namespaceURI!==r.dom.documentElement.namespaceURI)q=e("nse");else if(f.documentElement.nodeName!==r.dom.documentElement.nodeName)if(!b[0])q=e("dif");else if(!b[1]){var k=u('<?xml version="'+
(r.dom.xmlVersion?r.dom.xmlVersion:"1.0")+'" encoding="'+(r.dom.inputEncoding?r.dom.inputEncoding:r.dom.xmlEncoding?r.dom.xmlEncoding:"utf-8")+'"?>\r\n<'+b[0]+">\r\n</"+b[0]+">");if(k){var g=r.dom.documentElement.cloneNode(!0);k.documentElement.appendChild(g);g=k.createTextNode("\r\n");k.documentElement.appendChild(g);r.dom=k;b[1]=!0}else q=e("jne"),b[1]=null}if(q){var f=w(f.documentElement),m;for(m in f)r.nsp[m]||(r.dom.documentElement.setAttribute("xmlns:"+m,f[m]),r.nsp[m]=f[m]);n?1===p?h=l:t():
h=null}q?(v(a,"/"),!0===b[1]&&(a=r.dom.createTextNode("\r\n"),r.dom.documentElement.appendChild(a)),r.count++,a=r.dom):a=!1}return a};var u=function(e){var b;1===p?r.dom?(b=g.parseFromString(e,"text/xml"),e=0===b.getElementsByTagNameNS(d,"parsererror").length?b:!1):(r.dom=g.parseFromString(e,"text/xml"),e=0===r.dom.getElementsByTagNameNS(d,"parsererror").length?!0:!1):r.dom?(b=new ActiveXObject(k),b.async=!1,e=b.loadXML(e)?b:!1):(r.dom=new ActiveXObject(k),r.dom.async=!1,r.dom.setProperty("SelectionLanguage",
"XPath"),e=r.dom.loadXML(e)?!0:!1);return e},v=function(e,b){for(var a=0;a<e.childNodes.length;a++){var l,d=e.childNodes[a],f;l=e.childNodes;f=d;var h=b,k=a,g=void 0,g=void 0,u=0;if(1===f.nodeType){for(g=0;g<=k;g++)(n&&l[g].nodeType===f.nodeType&&l[g].nodeName===f.nodeName||!n&&7!==l[g].nodeType)&&u++;if(n){l=!1;k=w(f);g=void 0;for(g in k)"_"!==g&&(r.nsp[g]=k[g],l=2===p);l&&t();g=f.prefix?f.prefix+":":r.nsp._?"_:":"";g+=f.localName?f.localName:f.baseName}else g="node()"}else if(3===f.nodeType||8===
f.nodeType){for(g=0;g<=k;g++)l[g].nodeType===f.nodeType&&u++;g=3===f.nodeType?"text()":"comment()"}else g=h;u&&(g=h+("/"===h.slice(-1)?"":"/")+g+"["+u+"]");f=g;h=r.Query(f);if(1===d.nodeType){u=!0;if(null===h||h.namespaceURI!==d.namespaceURI)l=d.cloneNode(!0),h=r.Query(b),h.appendChild(l);else{l=h.getAttribute("stay");k=!1;g=void 0;for(g in l)if(l[g]===m){k=g;break}!1!==k&&(u=!1);if(u)try{for(l=0;l<d.attributes.length;l++)h.setAttribute(d.attributes[l].nodeName,d.attributes[l].nodeValue)}catch(y){}}d.hasChildNodes()&&
u&&v(d,f)}else if(3===d.nodeType||8===d.nodeType)null===h||h.nodeType!==d.nodeType?(h=r.Query(b),l=3===d.nodeType?r.dom.createTextNode(d.nodeValue):r.dom.createComment(d.nodeValue),h.appendChild(l)):h.nodeValue=d.nodeValue}},w=function(e){var b={};e=e.attributes;for(var l=0;l<e.length;++l){var a=e[l].name.split(":");"xmlns"===a[0]&&(b[a[1]?a[1]:"_"]=e[l].value)}return b};r.Query=function(e){var l;b[1]&&(e="/"+r.dom.documentElement.nodeName+("/"===e?"":e));try{1===p?(l=a.evaluate(e,r.dom,h,XPathResult.FIRST_ORDERED_NODE_TYPE,
null),l=l.singleNodeValue):l=r.dom.selectSingleNode(e)}catch(n){l=null}return l};var l=function(e){return r.nsp[e]||null},t=function(){var e="",b;for(b in r.nsp)e+=" xmlns:"+b+"='"+r.nsp[b]+"'";e&&r.dom.setProperty("SelectionNamespaces",e.substr(1))};r.Get=function(e,l){var a;e&&!l&&(l=r.dom);if(e)if(l)if(l.xml)a=l.xml;else try{a=(new XMLSerializer).serializeToString(l)}catch(n){a=null}else a="";else a=r.dom;if(a&&2===e){if(b[1]){var d=a.indexOf("<"+b[0]);a=a.substr(0,d)+"\r\n"+a.substr(d)}a=a.replace(/</g,
"&lt;").replace(/>/g,"&gt;").replace(/ |\t/g,"&nbsp;");a=a.replace(/(\r\n|\n|\r)/g,"<br>")}return a};var e=function(e){var b={nod:"XML DOM is not supported in this browser",nox:"xPath is not supported in this browser",nos:"Incompatible source object",nof:"File not found",emf:"File is empty",inv:"Invalid XML source",enc:"Different encoding",dif:"Different root nodes",jne:"Invalid join parameter",nse:"Namespace incompatibility",und:"Undefined error"};r.error.code=b[e]?e:"und";r.error.text=b[r.error.code];
return!1};"object"!==typeof f&&(f={});m="undefined"===typeof f.stay?["all"]:f.stay?"object"===typeof f.stay&&f.stay instanceof Array?f.stay:[f.stay]:[];b="undefined"===typeof f.join?["root"]:[f.join?String(f.join):!1];n="undefined"===typeof f.updn?!0:f.updn;p=function(){var e;e=!1;for(var b=["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","Microsoft.XmlDom"],l=b.length,n=0;n<l;n++)try{var t=new ActiveXObject(b[n]);t.async=!1;e=!0;if(t.loadXML("<x></x>")&&t.selectSingleNode("/"))break}catch(f){}e?
n<l?(k=b[n],e=2):e="nox":window.DOMParser?window.XPathEvaluator?(g=new DOMParser,d=g.parseFromString("Invalid","text/xml").getElementsByTagName("parsererror")[0].namespaceURI,a=new XPathEvaluator,e=1):e="nox":e="nod";return e}();"string"===typeof p&&(r.error={},e(p),p=0);r.Init()}});
define("enketo-js/utils",[],function(){return{parseFunctionFromExpression:function(f,p){var k,g,d,a=new RegExp(p+"\\s*\\(","g"),h=[];if(!f||!p)return h;for(;null!==(k=a.exec(f));){g=1;d=k.index;for(k=a.lastIndex;0!==g;)k++,"("===f[k]?g++:")"===f[k]&&g--;h.push([f.substring(d,k+1),f.substring(a.lastIndex,k).trim()])}return h}}});
var openrosa_xpath_extensions=function(){var f="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),p="Sun Mon Tue Wed Thu Fri Sat".split(" "),k=/^(-?[0-9]+)$/,g=/^\d\d\d\d-\d\d-\d\d(?:T\d\d:\d\d:\d\d(?:Z|[+-]\d\d:\d\d))?$/,d={boolean:function(b){return{t:"bool",v:b}},number:function(b){return{t:"num",v:b}},string:function(b){return{t:"str",v:b}},dateString:function(b){b=b.getFullYear()+"-"+a(b.getMonth()+1)+"-"+a(b.getDate());return d.string(b)}},a=function(b,a){a=a||2;for(b=b.toString();b.length<
a;)b="0"+b;return b},h=function(b){var a=16*Math.random()|0;return("x"==b?a:a&3|8).toString(16)},m=function(b,d){b=new Date(Date.parse(b));var h,k,g="",l=1900+b.getYear(),t=1+b.getMonth(),e=b.getDate(),q=b.getHours(),A=b.getMinutes(),Z=b.getSeconds(),m=b.getTime(),aa=b.getDay();for(k=0;k<d.length;++k)if(h=d.charAt(k),"%"===h){if(++k>=d.length)throw Error("date format string ends with %");h=d.charAt(k);if("%"===h)g+="%";else if("Y"===h)g+=a(l,4);else if("y"===h)g+=a(l,4).substring(2);else if("m"===
h)g+=a(t,2);else if("n"===h)g+=t;else if("b"===h)g+=f[t-1];else if("d"===h)g+=a(e,2);else if("e"===h)g+=e;else if("H"===h)g+=a(q,2);else if("h"===h)g+=q;else if("M"===h)g+=a(A,2);else if("S"===h)g+=a(Z,2);else if("3"===h)g+=a(m,3);else if("a"===h)g+=p[aa-1];else{if("Z"===h||"A"===h||"B"===h)throw Error("unsupported escape in date format string [%"+h+"]");throw Error("unrecognized escape in date format string [%"+h+"]");}}else g+=h;return g},b;b={"boolean-from-string":function(b){return d.boolean("1"===
b||"true"===b)},coalesce:function(b,a){return d.string(b||a)},date:function(b){if(k.test(b)){var a=new Date(0);a.setDate(1+parseInt(b,10));return d.dateString(a)}return g.test(b)?d.string(b.substring(0,10)):d.string("Invalid Date")},"decimal-date":function(b){return d.number(Date.parse(b)/864E5)},"false":function(){return d.boolean(!1)},"format-date":function(b,a){return d.string(m(b,a))},"if":function(b,a,h){return d.string(b?a:h)},int:function(b){return d.number(parseInt(b,10))},now:function(){return d.number(Date.now())},
pow:function(b,a){return d.number(Math.pow(b,a))},random:function(){return d.number(Math.random())},regex:function(b,a){return d.boolean((new RegExp(a)).test(b))},selected:function(b,a){return d.boolean(-1!==b.split(" ").indexOf(a))},substr:function(b,a,h){return d.string(b.slice(a,h))},today:function(){return d.dateString(new Date)},"true":function(){return d.boolean(!0)},uuid:function(){return d.string("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,h))}};b["date-time"]=b.date;b["decimal-date-time"]=
b["decimal-date"];b["format-date-time"]=b["format-date"];return b}();"function"===typeof define?define("openrosa-xpath-extensions",[],function(){return openrosa_xpath_extensions}):"object"===typeof module&&"object"===typeof module.exports&&(module.exports=openrosa_xpath_extensions);
var ExtendedXpathEvaluator=function(f,p){var k=function(a){return a.resultType===XPathResult.NUMBER_TYPE?{t:"num",v:a.numberValue}:a.resultType===XPathResult.BOOLEAN_TYPE?{t:"bool",v:a.booleanValue}:{t:"str",v:a.stringValue}},g=function(a){return"num"===a.t?{resultType:XPathResult.NUMBER_TYPE,numberValue:a.v,stringValue:a.v.toString()}:"bool"===a.t?{resultType:XPathResult.BOOLEAN_TYPE,booleanValue:a.v,stringValue:a.v.toString()}:{resultType:XPathResult.STRING_TYPE,stringValue:a.v.toString()}},d=function(a,
d){if(p.hasOwnProperty(a)){var b=[],n;for(n=0;n<d.length;++n)b.push(d[n].v);return p[a].apply(null,b)}var b="",g,u;for(u=0;u<d.length;++u)n=d[u],"num"!==n.t&&"bool"!==n.t&&(g=-1===n.v.indexOf('"')?'"':"'",b+=g),b+=n.v,"bool"===n.t&&(b+="()"),"num"!==n.t&&"bool"!==n.t&&(b+=g),u<d.length-1&&(b+=", ");return k(f(a+"("+b+")"))},a=function(a){switch(typeof a){case "boolean":return"bool";case "number":return"num";default:return"str"}};this.evaluate=function(h){var m,b=[{t:"root",tokens:[]}],n=function(){return b.slice(-1)[0]},
r=function(e){throw Error((e||"")+" [stack="+JSON.stringify(b)+"] [cur="+JSON.stringify(m)+"]");},p=function(){m={t:"?",v:""}},v=function(){var e,b,l,d,t;l=n().tokens;b=l.length;3<=b&&(d=l[b-3],t=l[b-2],b=l[b-1],"+"===t.t?e=d.v+b.v:"-"===t.t?e=d.v-b.v:"*"===t.t?e=d.v*b.v:"/"===t.t?e=d.v/b.v:"%"===t.t?e=d.v%b.v:"="===t.t?e=d.v===b.v:"<"===t.t?e=d.v<b.v:">"===t.t?e=d.v>b.v:"<="===t.t?e=d.v<=b.v:">="===t.t?e=d.v>=b.v:"!="===t.t&&(e=d.v!=b.v),"undefined"!==typeof e&&(l=l.slice(0,-3),l.push({t:a(e),v:e}),
n().tokens=l))},w=function(){var e;e=m.v.trim();e=/^-?[0-9]+(\.[0-9]+)?$/.test(e)?{t:"num",v:parseFloat(e)}:k(f(m.v));n().tokens.push(e);p();v()},l=function(){if(i<h.length-1)return h.charAt(i+1)};p();for(i=0;i<h.length;++i)if(c=h.charAt(i),"str"===m.t)c===m.quote?(n().tokens.push(m),v(),p()):m.v+=c;else switch(c){case "'":case '"':"?"===m.t&&""===m.v?m={t:"str",quote:c,v:""}:r("Not sure how to handle: "+c);break;case "(":"?"===m.t&&""!==m.v?(m.t="fn",m.tokens=[],b.push(m),p()):r();break;case ")":if("?"===
m.t){""!==m.v&&w();var t=b.pop();"fn"!==t.t&&r();n().tokens.push(d(t.v,t.tokens));v();p()}else r();break;case ",":"?"===m.t?(""!==m.v&&w(),"fn"!==n().t&&r()):r();break;case "-":if(!(t=/[0-9]/.test(l()))&&(t=" "!==l())&&(t=0<i?h.charAt(i-1):void 0,t=" "!==t),t){m.v+=c;break}case "=":if("="===c&&("<"===m.v||"&lt;"===m.v||">"===m.v||"&gt;"===m.v||"!"===m.v)){m.v+=c;break}case ">":case "<":if(("<"===c||">"===c)&&"="===l()){m.v+=c;break}case "+":case "*":"?"===m.t?(""!==m.v&&w(),n().tokens.push({t:c})):
r();break;case " ":if("?"===m.t){""!==m.v&&("mod"===m.v?(n().tokens.push({t:"%"}),p()):"div"===m.v?(n().tokens.push({t:"/"}),p()):"&lt;"===m.v?(n().tokens.push({t:"<"}),p()):"&gt;"===m.v?(n().tokens.push({t:">"}),p()):"<="===m.v||"&lt;="===m.v?(n().tokens.push({t:"<="}),p()):">="===m.v||"&gt;="===m.v?(n().tokens.push({t:">="}),p()):"!="===m.v?(n().tokens.push({t:"!="}),p()):w());break}default:m.v+=c}"?"===m.t&&""!==m.v&&w();("?"!==m.t||""!==m.v||m.tokens&&current.tokens.length)&&r("Current item not evaluated!");
1<b.length&&r("Stuff left on stack.");"root"!==b[0].t&&r("Weird stuff on stack.");0===b[0].tokens.length&&r("No tokens.");1<b[0].tokens.length&&r("Too many tokens.");return g(b[0].tokens[0])}};"function"===typeof define?define("extended-xpath",[],function(){return ExtendedXpathEvaluator}):"object"===typeof module&&"object"===typeof module.exports&&(module.exports=ExtendedXpathEvaluator);
define("enketo-js/plugins",["jquery"],function(f){f.fn.clearInputs=function(p){p=p||"edit";return this.each(function(){f(this).find(".file-preview").remove();f(this).find("input, select, textarea").not(".ignore").each(function(){var k=f(this),g=k.attr("type");"SELECT"===k.prop("nodeName").toUpperCase()&&(g="select");"TEXTAREA"===k.prop("nodeName").toUpperCase()&&(g="textarea");switch(g){case "date":case "datetime":case "time":case "number":case "search":case "color":case "range":case "url":case "email":case "password":case "text":case "file":k.removeAttr("data-previous-file-name data-loaded-file-name");
case "hidden":case "textarea":""!==k.val()&&k.val("").trigger(p);break;case "radio":case "checkbox":k.prop("checked")&&(k.prop("checked",!1),k.trigger(p));break;case "select":0<=k[0].selectedIndex&&(k[0].selectedIndex=-1,k.trigger(p));break;default:console.error("Unrecognized input type found when trying to reset",this)}})})};f.fn.markdownToHtml=function(){return this.each(function(){var p,k=f("<div/>");f(this).children(":not(input, select, textarea)").each(function(g){g="$$$"+g;f(this).clone().markdownToHtml().appendTo(k);
f(this).replaceWith(g)});p=f(this).html();p=p.replace(/__([^\s][^_]*[^\s])__/gm,"<strong>$1</strong>");p=p.replace(/\*\*([^\s][^\*]*[^\s])\*\*/gm,"<strong>$1</strong>");p=p.replace(/_([^\s][^_]*[^\s])_/gm,"<em>$1</em>");p=p.replace(/\*([^\s][^\*]*[^\s])\*/gm,"<em>$1</em>");p=p.replace(/\[([^\]]*)\]\(([^\)]+)\)/gm,'<a href="$2" target="_blank">$1</a>');p=p.replace(/\n/gm,"<br />");k.children().each(function(g){p=p.replace(new RegExp("\\$\\$\\$"+g),f(this)[0].outerHTML)});f(this).text("").append(p)})};
f.fn.reverse=[].reverse});define("enketo-js/extend",["require"],function(f){String.prototype.pad=function(f){for(var k=this;k.length<f;)k="0"+k;return k};Date.prototype.toISOLocalString=function(){var f,k,g,d;d=function(a){return 10>a?"0"+a:a};if("Invalid Date"===this.toString())return this.toString();f=this.getTimezoneOffset();k=0>f?"+":"-";g=d(Math.abs(Math.floor(f/60)));d=d(Math.abs(Math.floor(f%60)));return(new Date(this.getTime()-6E4*f)).toISOString().replace("Z",k+g+":"+d)}});
(function(f){"function"===typeof define&&define.amd?define("jquery.xpath",["jquery"],f):f(jQuery)})(function(f){f.fn.getXPath=function(f,k){var g,d=[];g="";var a=this.first(),h=a.prop("nodeName"),m=a.parent(),b=m.prop("nodeName");f=f||"#document";if(k=k||!1)g=a.siblings(h).addBack(),g=1<g.length?"["+(g.index(a)+1)+"]":"";for(d.push(h+g);1==m.length&&b!==f&&"#document"!==b;)k&&(g=m.siblings(b).addBack(),g=1<g.length?"["+(g.index(m)+1)+"]":""),d.push(b+g),m=m.parent(),b=m.prop("nodeName");return"/"+
d.reverse().join("/")};f.fn.xfind=function(f){var k,g;f=f.replace(/\/\//g," ");f=f.replace(/^\//,"");f=f.replace(/\/\.$/,"");f=f.replace(/\//g,">");f=f.replace(/\[([^@].*?)\]/g,function(d,a){return":has("+a+")"});if(0<=f.indexOf(">..")){f=f.split(/>\.\.>?/g);k=jQuery(f[0],this);for(g=1;g<f.length;g++)k=k.parent(f[g]);return k.get()}f=f.replace(/\./gi,"\\.");return this.find(f)}});
define("enketo-js/FormModel","merge-xml enketo-js/utils jquery openrosa-xpath-extensions extended-xpath enketo-js/plugins enketo-js/extend jquery.xpath".split(" "),function(f,p,k,g,d){var a,h,m;a=function(b,a){"string"===typeof b&&(b={modelStr:b});b.external=b.external||[];b.submitted="undefined"!==typeof b.submitted?b.submitted:!0;a=a||{};a.full="undefined"!==typeof a.full?a.full:!0;this.convertedExpressions={};this.templates={};this.loadErrors=[];this.INSTANCE=/instance\([\'|\"]([^\/:\s]+)[\'|\"]\)/g;
this.OPENROSA=/(decimal-date-time\(|pow\(|indexed-repeat\(|format-date\(|coalesce\(|join\(|max\(|min\(|random\(|substr\(|int\(|uuid\(|regex\(|now\(|today\(|date\(|if\(|boolean-from-string\(|checklist\(|selected\(|selected-at\(|round\(|area\(|position\([^\)])/;this.data=b;this.options=a};a.prototype.init=function(){var b,a,d,f=this;this.data.modelStr=this.data.modelStr.replace(/\s(xmlns\=("|')[^\s\>]+("|'))/g," data-$1");this.options.full||(this.data.modelStr=this.data.modelStr.replace(/^(<model\s*><instance((?!<instance).)+<\/instance\s*>\s*)(<instance.+<\/instance\s*>)*/,
"$1"));try{b="model",this.xml=k.parseXML(this.data.modelStr),this.data.external.forEach(function(l){b='instance "'+l.id+'"'||"instance unknown";a=f.xml.getElementById(l.id);(d=a.querySelector("root"))&&a.removeChild(d);a.appendChild(k.parseXML(l.xmlStr).firstChild)})}catch(h){console.error(h),this.loadErrors.push("Error trying to parse XML "+b+". "+h.message)}if(this.xml){this.$=k(this.xml);this.hasInstance=!!this.xml.querySelector("model > instance")||!1;this.rootElement=this.xml.querySelector("instance > *")||
this.xml.documentElement;this.$.find("model > instance[src]:empty").each(function(b,a){f.loadErrors.push('External instance "'+k(a).attr("id")+'" is empty.')});this.trimValues();this.cloneAllTemplates();this.extractTemplates();try{b="record",this.data.instanceStr&&(this.mergeXml(this.data.instanceStr),this.data.submitted&&this.deprecateId())}catch(g){console.error(g),this.loadErrors.push("Error trying to parse XML "+b+". "+g.message)}}return this.loadErrors};a.prototype.node=function(b,a,d){return new h(b,
a,d,this)};a.prototype.mergeXml=function(b){var a,d,h,g;if(b){h=this.xml.querySelector("instance");g=this.xml.querySelector("instance > *");if(!g)throw Error("Model is corrupt. It does not contain a childnode of instance");d=new f({join:!1});a=(new XMLSerializer).serializeToString(g);d.AddSource(a);d.AddSource(b);if(d.error.code)throw Error(d.error.text);this.xml.querySelector("instance").removeChild(g);g=this.xml.adoptNode(d.Get(0).documentElement,!0);h.appendChild(g);this.rootElement=g}};a.prototype.trimValues=
function(){this.node(null,null,{noEmpty:!0}).get().each(function(){this.textContent=this.textContent.trim()})};a.prototype.deprecateId=function(){var b,a,d;b=this.xml.querySelectorAll("* > meta > instanceID");if(1!==b.length)throw Error("Invalid primary instance. Found "+b.length+" instanceID nodes but expected 1.");b=b[0];a=this.xml.querySelectorAll("* > meta > deprecatedID");if(1<a.length)throw Error("Invalid primary instance. Found "+a.length+" deprecatedID nodes but expected 1.");a=a[0];a||(a=
k.parseXML("<deprecatedID/>").documentElement,this.xml.adoptNode(a),d=this.xml.querySelector("* > meta"),d.appendChild(a));a.textContent=b.textContent;b.textContent=""};a.prototype.bindJsEvaluator=function(){var b=new XPathEvaluator;this.xml.jsCreateExpression=function(){return b.createExpression.apply(b,arguments)};this.xml.jsCreateNSResolver=function(){return b.createNSResolver.apply(b,arguments)};console.log("Certainly not the eggman.");this.xml.jsEvaluate=function(b,a,f,h,k){console.log("Calling custom evaluator for: "+
b);b=(new d(function(b){return a.ownerDocument.evaluate(b,a,f,XPathResult.STRING_TYPE,k)},g)).evaluate(b);console.log("    -> "+b);return b};window.JsXPathException=window.JsXPathExpression=window.JsXPathNSResolver=window.JsXPathResult=window.JsXPathNamespace=!0};a.prototype.getInstanceID=function(){return this.node("/*/meta/instanceID").getVal()[0]};a.prototype.getInstanceName=function(){return this.node("/*/meta/instanceName").getVal()[0]};a.prototype.cloneRepeat=function(b,a){var d,f,h,g=this.templates[b]||
this.node(b,0).get();f=g.prop("nodeName");d=this.node(b,a).get();g[0]&&1===d.length&&0===d.nextAll(f).length?(d=g.clone().insertAfter(d),h=[g.prop("nodeName")],g.find("*").each(function(){h.push(k(this).prop("nodeName"))}),this.$.trigger("dataupdate",{nodes:h,repeatPath:b,repeatIndex:this.node(b,a).determineIndex(d)})):0===d.nextAll(f).length&&console.error("Could not find template node and/or node to insert the clone after")};a.prototype.extractTemplates=function(){var b=this;this.evaluate("/model/instance[1]/*//*[@template] | /model/instance[1]/*//*[@jr:template]",
"nodes",null,null,!0).reverse().forEach(function(a){a=k(a);b.templates[a.getXPath("instance")]=a.removeAttr("template").removeAttr("jr:template").remove()})};a.prototype.getTemplatePath=function(b){var a,d=this;b.split("/").some(function(b,f,h){a=h.slice(0,h.length-f).join("/");return d.templates[a]});return a||void 0};a.prototype.cloneAllTemplates=function(){var b=this;this.evaluate("/model/instance[1]/*//*[@template] | /model/instance[1]/*//*[@jr:template]","nodes",null,null,!0).forEach(function(a){var d=
a.nodeName,f=k(a).getXPath("instance");0===b.evaluate("ancestor::"+d+"[@template] | ancestor::"+d+"[@jr:template]","nodes",f,0,!0).length&&0===k(a).siblings(d).length&&k(a).clone().insertAfter(k(a)).find("*").addBack().removeAttr("template").removeAttr("jr:template")})};a.prototype.get=function(){return this.$||null};a.prototype.getXML=function(){return this.xml||null};a.prototype.getStr=function(){var b=(new XMLSerializer).serializeToString(this.xml.querySelector("instance > *")||this.xml.documentElement,
"text/xml"),b=b.replace(/\t/g,"");return b=b.replace(/\s(data-)(xmlns\=("|')[^\s\>]+("|'))/g," $2")};a.prototype.makeBugCompliant=function(b,a,d){var f,h,g;a=this.node(a,d).get();d=a.parents().add(a);for(a=d.length-1;0<=a;a--)h=d.eq(a),f=h.prop("nodeName").replace(/\./g,"\\."),g=h.siblings(f).not("[template]"),"instance"!==f.toLowerCase()&&"model"!==f.toLowerCase()&&0<g.length&&(f=h.getXPath("instance"),h=g.add(h).index(h),b=b.replace(new RegExp(f,"g"),f+"["+(h+1)+"]"));return b};a.prototype.nsResolver=
{lookupNamespaceURI:function(b){return{jr:"http://openrosa.org/javarosa",xsd:"http://www.w3.org/2001/XMLSchema",orx:"http://openrosa.org/xforms/",cc:"http://commcarehq.org/xforms"}[b]||null}};a.prototype.shiftRoot=function(b){this.hasInstance&&(b=b.replace(/^(\/(?!model\/)[^\/][^\/\s]*\/)/g,"/model/instance[1]$1"),b=b.replace(/([^a-zA-Z0-9\.\]\)\/\*_-])(\/(?!model\/)[^\/][^\/\s]*\/)/g,"$1/model/instance[1]$2"));return b};a.prototype.replaceInstanceFn=function(b){return b.replace(this.INSTANCE,function(b,
a){return'/model/instance[@id="'+a+'"]'})};a.prototype.replaceCurrentFn=function(b){b=b.replace(/current\(\)\/\./g,".");return b=b.replace(/current\(\)/g,"")};a.prototype.replaceIndexedRepeatFn=function(b,a,d){var f=this,h=p.parseFunctionFromExpression(b,"indexed-repeat");if(!h.length)return b;h.forEach(function(h){var l,t,e,q=h[1].split(",");if(1===q.length%2){q=q.map(function(e){return e.trim()});t=q[0];for(l=q.length-1;1<l;l-=2)e=isNaN(q[l])?f.evaluate(q[l],"number",a,d,!0):q[l],t=t.replace(q[l-
1],q[l-1]+"[position() = "+e+"]");b=b.replace(h[0],t)}else return console.error("indexed repeat with incorrect number of parameters found",h[0]),'"Error with indexed-repeat parameters"'});return b};a.prototype.evaluate=function(b,a,d,f,h){var g,l,t,e,q,A,m;h=h||!1;a=a||"any";f=f||0;t=this.xml;A=null;d?(l=this.node(d).get(),A=l.length,l=l.eq(f)[0]):l=this.rootElement;m=[b,d,f,A].join("|");this.convertedExpressions[m]?b=this.convertedExpressions[m]:(b=b.trim(),b=this.shiftRoot(b),b=this.replaceInstanceFn(b),
b=this.replaceCurrentFn(b),b=this.replaceIndexedRepeatFn(b,d,f),A&&1<A&&(b=this.makeBugCompliant(b,d,f)),b=b.replace(/&lt;/g,"<"),b=b.replace(/&gt;/g,">"),b=b.replace(/&quot;/g,'"'),this.convertedExpressions[m]=b);d={0:["any","ANY_TYPE"],1:["number","NUMBER_TYPE","numberValue"],2:["string","STRING_TYPE","stringValue"],3:["boolean","BOOLEAN_TYPE","booleanValue"],7:["nodes","ORDERED_NODE_SNAPSHOT_TYPE"],9:["node","FIRST_ORDERED_NODE_TYPE","singleNodeValue"]};for(e in d)if(d.hasOwnProperty(e))if(e=Number(e),
d[e][0]===a)break;else e=0;if(h&&"undefined"!==typeof t.evaluate&&!this.OPENROSA.test(b))try{g=t.evaluate(b,l,this.nsResolver,e,null)}catch(U){console.log("%cWell native XPath evaluation did not work... No worries, worth a shot, the expression probably contained unknown OpenRosa functions or errors:","color:orange",b)}if(!g)try{"undefined"===typeof t.jsEvaluate&&this.bindJsEvaluator(),g=t.jsEvaluate(b,l,this.nsResolver,e,null)}catch(p){return g="Error occurred trying to evaluate: "+b+", message: "+
p.message,console.error(g),k(document).trigger("xpatherror",g),this.loadErrors.push(g),null}if(g){if(0===e){for(e in d)if(d.hasOwnProperty(e)&&(e=Number(e),e===Number(g.resultType)&&0<e&&4>e)){q=g[d[e][2]];break}console.error("Expression: "+b+" did not return any boolean, string or number value as expected")}else if(7===e)for(q=[],b=0;b<g.snapshotLength;b++)q.push(g.snapshotItem(b));else q=g[d[e][2]];return q}};h=function(b,a,d,f){var h=f.hasInstance?"/model/instance[1]//*":"//*";this.model=f;this.originalSelector=
b;this.selector="string"===typeof b&&0<b.length?b:h;this.filter=d="undefined"!==typeof d&&null!==d?d:{};this.filter.onlyLeaf="undefined"!==typeof d.onlyLeaf?d.onlyLeaf:!1;this.filter.noEmpty="undefined"!==typeof d.noEmpty?d.noEmpty:!1;this.index=a};h.prototype.get=function(){var b,a;this.nodes||(this.nodes=this.model.evaluate(this.selector,"nodes",null,null,!0));b=!0===this.filter.noEmpty?k(this.nodes).filter(function(){var b=k(this);a=b.text();return 0===b.children().length&&0<a.trim().length}):
!0===this.filter.onlyLeaf?k(this.nodes).filter(function(){return 0===k(this).children().length}):k(this.nodes);return"undefined"!==typeof this.index&&null!==this.index?b.eq(this.index):b};h.prototype.setIndex=function(b){this.index=b};h.prototype.setVal=function(b,a,d){var f,h;f=this.getVal()[0];h="undefined"!==typeof b&&null!==b?k.isArray(b)?b.join(" "):b.toString():"";h=this.convert(h,d);b=this.get();if(1===b.length&&k.trim(h.toString())!==k.trim(f.toString()))return b.text(h),a=this.validate(a,
d),f=this.getClosestRepeat(),f.nodes=[b.prop("nodeName")],this.model.$.trigger("dataupdate",f),"binary"===d&&(0<h.length?b.attr("type","file"):b.removeAttr("type")),a;if(1<b.length)return console.error("nodeset.setVal expected nodeset with one node, but received multiple"),null;0===b.length&&console.error("Data node: "+this.selector+" with null-based index: "+this.index+" not found. Ignored.");return null};h.prototype.getVal=function(){var b=[];this.get().each(function(){b.push(k(this).text())});
return b};h.prototype.determineIndex=function(b){var a,d;b=b||this.get();if(1===b.length)return a=b.prop("nodeName"),d=b.getXPath("instance"),a=this.model.$.find(a).filter(function(){return d===k(this).getXPath("instance")}),1===a.length?null:a.index(b);console.error("no node, or multiple nodes, provided to nodeset.determineIndex");return-1};h.prototype.getClosestRepeat=function(){for(var b=this.get(),a=b.prop("nodeName");0===b.siblings(a).length&&"instance"!==a;)b=b.parent(),a=b.prop("nodeName");
return"instance"===a?{}:{repeatPath:b.getXPath("instance"),repeatIndex:this.determineIndex(b)}};h.prototype.remove=function(){var b,a,d,f,h;b=this.get();0<b.length?(a=[b.prop("nodeName")],b.find("*").each(function(){d=k(this);a.push(d.prop("nodeName"))}),f=b.getXPath("instance"),h=this.determineIndex(b),b.remove(),this.nodes=null,this.model.$.trigger("dataupdate",{updatedNodes:a,repeatPath:f,repeatIndex:h})):console.error("could not find node "+this.selector+" with index "+this.index+" to remove ")};
h.prototype.convert=function(b,a){return""===b.toString()?b:"undefined"!==typeof a&&null!==a&&"undefined"!==typeof m[a.toLowerCase()]&&"undefined"!==typeof m[a.toLowerCase()].convert?m[a.toLowerCase()].convert(b):b};h.prototype.validate=function(b,a){var d,f;a&&"undefined"!==typeof m[a.toLowerCase()]||(a="string");if(!b&&("string"===a||"select"===a||"select1"===a||"binary"===a))return!0;d=this.getVal()[0];if(""===d.toString())return!0;d=m[a.toLowerCase()].validate(d);f="undefined"!==typeof b&&null!==
b&&0<b.length?this.model.evaluate(b,"boolean",this.originalSelector,this.index):!0;return d&&f};m={string:{validate:function(){return!0}},select:{validate:function(){return!0}},select1:{validate:function(){return!0}},decimal:{validate:function(b){return isNaN(b-0)||null===b?!1:!0},convert:function(b){return"NaN"===b?"":b}},"int":{validate:function(b){return isNaN(b-0)||null===b||Math.round(b).toString()!==b.toString()?!1:!0},convert:function(b){return"NaN"===b?"":b}},date:{validate:function(b){return(b=
/([0-9]{4})([\-]|[\/])([0-9]{2})([\-]|[\/])([0-9]{2})/.exec(b))&&6===b.length?"Invalid Date"!==(new Date(Number(b[1]),Number(b[3])-1,Number(b[5]))).toString():!1},convert:function(b){var a=/([0-9]{4})([\-]|[\/])([0-9]{2})([\-]|[\/])([0-9]{2})/.exec(b),d=new Date(b);"Invalid Date"===(new Date(b)).toString()&&a&&0<Number(a[1])&&0<=Number(a[3])&&12>Number(a[3])&&32>Number(a[5])&&(d=new Date(Number(a[1]),Number(a[3])-1,Number(a[5])));return d.getUTCFullYear().toString().pad(4)+"-"+(d.getUTCMonth()+1).toString().pad(2)+
"-"+d.getUTCDate().toString().pad(2)}},datetime:{validate:function(b){return"Invalid Date"!==(new Date(b.toString())).toString()||"Invalid Date"!==(new Date(this.convert(b.toString()))).toString()},convert:function(b){var a=/([0-9]{4}\-[0-9]{2}\-[0-9]{2})([T]|[\s])([0-9]){2}:([0-9]){2}([0-9:.]*)(\+|\-)([0-9]{2}):([0-9]{2})$/,d=/([0-9]{4}\-[0-9]{2}\-[0-9]{2})([T]|[\s])([0-9]){2}:([0-9]){2}([0-9:.]*)(\+|\-)([0-9]{2})$/;if("Invalid Date"!==(new Date(b)).toString()&&a.test(b))return b;if("Invalid Date"===
(new Date(b)).toString()&&d.test(b))return b+":00";b=new Date(b);return"Invalid Date"!==b.toString()?b.toISOLocalString():b.toString()}},time:{validate:function(b){var a=new Date;b=b.toString().split(":");if(2>b.length)return!1;b[2]=b[2]?Number(b[2].toString().split(".")[0]):0;return 24>b[0]&&0<=b[0]&&60>b[1]&&0<=b[1]&&60>b[2]&&0<=b[2]&&"Invalid Date"!==a.toString()},convert:function(a){var d=a.toString().split(":");k.each(d,function(a,b){d[a]=b.toString().pad(2)});return d.join(":")}},barcode:{validate:function(){return!0}},
geopoint:{validate:function(a){a=a.toString().trim().split(" ");return""!==a[0]&&-90<=a[0]&&90>=a[0]&&""!==a[1]&&-180<=a[1]&&180>=a[1]&&("undefined"===typeof a[2]||!isNaN(a[2]))&&("undefined"===typeof a[3]||!isNaN(a[3])&&0<=a[3])},convert:function(a){return k.trim(a.toString())}},geotrace:{validate:function(a){a=a.toString().split(";");return 2<=a.length&&a.every(function(a){return m.geopoint.validate(a)})},convert:function(a){return a.toString().trim()}},geoshape:{validate:function(a){console.debug("validating geoshape, this: ",
this);a=a.toString().split(";");return 4<=a.length&&a[0]===a[a.length-1]&&a.every(function(a){return m.geopoint.validate(a)})},convert:function(a){return a.toString().trim()}},binary:{validate:function(){return!0}}};return a});
define("text",["module"],function(f){var p,k,g,d,a,h=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],m=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,b=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,n="undefined"!==typeof location&&location.href,r=n&&location.protocol&&location.protocol.replace(/\:/,""),u=n&&location.hostname,v=n&&(location.port||void 0),w={},l=f.config&&f.config()||{};p={version:"2.0.10",strip:function(a){if(a){a=a.replace(m,"");var e=a.match(b);e&&(a=e[1])}else a=
"";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:l.createXhr||function(){var a,e,b;if("undefined"!==typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!==typeof ActiveXObject)for(e=0;3>e;e+=1){b=h[e];try{a=new ActiveXObject(b)}catch(l){}if(a){h=[b];break}}return a},parseName:function(a){var e,
b,l=!1,d=a.indexOf(".");e=0===a.indexOf("./")||0===a.indexOf("../");-1!==d&&(!e||1<d)?(e=a.substring(0,d),b=a.substring(d+1,a.length)):e=a;a=b||e;d=a.indexOf("!");-1!==d&&(l="strip"===a.substring(d+1),a=a.substring(0,d),b?b=a:e=a);return{moduleName:e,ext:b,strip:l}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,e,b,l){var d,f;d=p.xdRegExp.exec(a);if(!d)return!0;a=d[2];d=d[3];d=d.split(":");f=d[1];d=d[0];return(!a||a===e)&&(!d||d.toLowerCase()===b.toLowerCase())&&(!f&&!d||f===l)},finishLoad:function(a,
e,b,d){b=e?p.strip(b):b;l.isBuild&&(w[a]=b);d(b)},load:function(a,e,b,d){if(d.isBuild&&!d.inlineText)b();else{l.isBuild=d.isBuild;var f=p.parseName(a);d=f.moduleName+(f.ext?"."+f.ext:"");var h=e.toUrl(d),g=l.useXhr||p.useXhr;0===h.indexOf("empty:")?b():!n||g(h,r,u,v)?p.get(h,function(e){p.finishLoad(a,f.strip,e,b)},function(a){b.error&&b.error(a)}):e([d],function(a){p.finishLoad(f.moduleName+"."+f.ext,f.strip,a,b)})}},write:function(a,e,b,d){w.hasOwnProperty(e)&&(d=p.jsEscape(w[e]),b.asModule(a+"!"+
e,"define(function () { return '"+d+"';});\n"))},writeFile:function(a,e,b,d,l){e=p.parseName(e);var f=e.ext?"."+e.ext:"",h=e.moduleName+f,g=b.toUrl(e.moduleName+f)+".js";p.load(h,b,function(e){e=function(a){return d(g,a)};e.asModule=function(a,e){return d.asModule(a,g,e)};p.write(a,h,e,l)},l)}};if("node"===l.env||!l.env&&"undefined"!==typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"])k=require.nodeRequire("fs"),p.get=function(a,e,b){try{var d=k.readFileSync(a,
"utf8");0===d.indexOf("\ufeff")&&(d=d.substring(1));e(d)}catch(l){b(l)}};else if("xhr"===l.env||!l.env&&p.createXhr())p.get=function(a,e,b,d){var f=p.createXhr(),h;f.open("GET",a,!0);if(d)for(h in d)d.hasOwnProperty(h)&&f.setRequestHeader(h.toLowerCase(),d[h]);if(l.onXhr)l.onXhr(f,a);f.onreadystatechange=function(d){if(4===f.readyState&&(d=f.status,399<d&&600>d?(d=Error(a+" HTTP status: "+d),d.xhr=f,b(d)):e(f.responseText),l.onXhrComplete))l.onXhrComplete(f,a)};f.send(null)};else if("rhino"===l.env||
!l.env&&"undefined"!==typeof Packages&&"undefined"!==typeof java)p.get=function(a,e){var b,d,l=new java.io.File(a),f=java.lang.System.getProperty("line.separator"),l=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(l),"utf-8")),h="";try{b=new java.lang.StringBuffer;(d=l.readLine())&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1));for(null!==d&&b.append(d);null!==(d=l.readLine());)b.append(f),b.append(d);h=String(b.toString())}finally{l.close()}e(h)};else if("xpconnect"===
l.env||!l.env&&"undefined"!==typeof Components&&Components.classes&&Components.interfaces)g=Components.classes,d=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in g,p.get=function(b,e){var l,f,h,k={};a&&(b=b.replace(/\//g,"\\"));h=new FileUtils.File(b);try{l=g["@mozilla.org/network/file-input-stream;1"].createInstance(d.nsIFileInputStream),l.init(h,1,0,!1),f=g["@mozilla.org/intl/converter-input-stream;1"].createInstance(d.nsIConverterInputStream),
f.init(l,"utf-8",l.available(),d.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),f.readString(l.available(),k),f.close(),l.close(),e(k.value)}catch(n){throw Error((h&&h.path||"")+": "+n);}};return p});define("text!enketo-config",[],function(){return'{\n    "widgets": [\n        "enketo-widget/note/notewidget",\n        "enketo-widget/select-desktop/selectpicker",\n        "enketo-widget/select-mobile/selectpicker",\n        "enketo-widget/table/tablewidget",\n        "enketo-widget/radio/radiopicker",\n        "enketo-widget/date/datepicker-extended",\n        "enketo-widget/time/timepicker-extended",\n        "enketo-widget/datetime/datetimepicker-extended",\n        "enketo-widget/mediagrid/mediagridpicker",\n        "enketo-widget/select-likert/likertitem"\n    ],\n    "maps": [ {\n        "tiles": [ "http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png" ],\n        "name": "streets",\n        "attribution": "Map data \u00a9 <a href=\\"http://openstreetmap.org\\">OpenStreetMap</a> contributors"\n    }, {\n        "tiles": "GOOGLE_SATELLITE",\n        "name": "satellite"\n    } ],\n    "googleApiKey": ""\n}\n'});
define("enketo-js/support",[],function(){var f={inputtypes:{}};["date","datetime","time"].forEach(function(p){var k=document.createElement("input");k.setAttribute("type",p);f.inputtypes[p]="text"!==k.type});"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?(f.touch=!0,document.documentElement.classList+=" touch"):f.touch=!1;return f});
(function(f){"function"===typeof bootstrap?bootstrap("promise",f):"object"===typeof exports?module.exports=f():"function"===typeof define&&define.amd?define("q",f):"undefined"!==typeof ses?ses.ok()&&(ses.makeQ=f):Q=f()})(function(){function f(a){return function(){return K.apply(a,arguments)}}function p(a,e){if(R&&e.stack&&"object"===typeof a&&null!==a&&a.stack&&-1===a.stack.indexOf("From previous event:")){for(var b=[],d=e;d;d=d.source)d.stack&&b.unshift(d.stack);b.unshift(a.stack);for(var b=b.join("\nFrom previous event:\n").split("\n"),
d=[],l=0;l<b.length;++l){var f=b[l],q;if(q=k(f)){var h=q[1];q=q[0]===W&&h>=O&&h<=S}else q=!1;q||(q=f,q=-1!==q.indexOf("(module.js:")||-1!==q.indexOf("(node.js:"));q||!f||d.push(f)}b=d.join("\n");a.stack=b}}function k(a){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(e||(e=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a)))return[e[1],Number(e[2])];if(a=/.*@(.+):(\d+)$/.exec(a))return[a[1],Number(a[2])]}function g(){if(R)try{throw Error();}catch(a){var e=a.stack.split("\n"),e=0<e[0].indexOf("@")?e[1]:e[2];if(e=
k(e))return W=e[0],e[1]}}function d(a){return u(a)?a:v(a)?q(a):e(a)}function a(){function l(a){h=a;k.source=a;X(f,function(e,b){y(function(){a.promiseDispatch.apply(a,b)})},void 0);q=f=void 0}var f=[],q=[],h,g=V(a.prototype),k=V(b.prototype);k.promiseDispatch=function(a,e,b){var d=z(arguments);f?(f.push(d),"when"===e&&b[1]&&q.push(b[1])):y(function(){h.promiseDispatch.apply(h,d)})};k.valueOf=function(){if(f)return k;var a=r(h);u(a)&&(h=a);return a};k.inspect=function(){return h?h.inspect():{state:"pending"}};
if(d.longStackSupport&&R)try{throw Error();}catch(A){k.stack=A.stack.substring(A.stack.indexOf("\n")+1)}g.promise=k;g.resolve=function(a){h||l(d(a))};g.fulfill=function(a){h||l(e(a))};g.reject=function(a){h||l(t(a))};g.notify=function(a){h||X(q,function(e,b){y(function(){b(a)})},void 0)};return g}function h(e){if("function"!==typeof e)throw new TypeError("resolver must be a function.");var b=a();try{e(b.resolve,b.reject,b.notify)}catch(d){b.reject(d)}return b.promise}function m(a){return h(function(e,
b){for(var l=0,f=a.length;l<f;l++)d(a[l]).then(e,b)})}function b(a,e,d){void 0===e&&(e=function(a){return t(Error("Promise does not support operation: "+a))});void 0===d&&(d=function(){return{state:"unknown"}});var l=V(b.prototype);l.promiseDispatch=function(b,d,f){var q;try{q=a[d]?a[d].apply(l,f):e.call(l,d,f)}catch(h){q=t(h)}b&&b(q)};if(l.inspect=d){var f=d();"rejected"===f.state&&(l.exception=f.reason);l.valueOf=function(){var a=d();return"pending"===a.state||"rejected"===a.state?l:a.value}}return l}
function n(a,e,b,l){return d(a).then(e,b,l)}function r(a){if(u(a)){var e=a.inspect();if("fulfilled"===e.state)return e.value}return a}function u(a){return a===Object(a)&&"function"===typeof a.promiseDispatch&&"function"===typeof a.inspect}function v(a){return a===Object(a)&&"function"===typeof a.then}function w(){M.length=0;P.length=0;I||(I=!0)}function l(a,e){I&&(P.push(a),e&&"undefined"!==typeof e.stack?M.push(e.stack):M.push("(no stack) "+e))}function t(a){var e=b({when:function(e){if(e&&I){var b=
J(P,this);-1!==b&&(P.splice(b,1),M.splice(b,1))}return e?e(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});l(e,a);return e}function e(a){return b({when:function(){return a},get:function(e){return a[e]},set:function(e,b){a[e]=b},"delete":function(e){delete a[e]},post:function(e,b){return null===e||void 0===e?a.apply(void 0,b):a[e].apply(a,b)},apply:function(e,b){return a.apply(e,b)},keys:function(){return E(a)}},void 0,function(){return{state:"fulfilled",value:a}})}
function q(e){var b=a();y(function(){try{e.then(b.resolve,b.reject,b.notify)}catch(a){b.reject(a)}});return b.promise}function A(a,e,b){return d(a).spread(e,b)}function Z(a,e,b){return d(a).dispatch(e,b)}function U(e){return n(e,function(e){var b=0,d=a();X(e,function(a,l,f){var q;u(l)&&"fulfilled"===(q=l.inspect()).state?e[f]=q.value:(++b,n(l,function(a){e[f]=a;0===--b&&d.resolve(e)},d.reject,function(a){d.notify({index:f,value:a})}))},void 0);0===b&&d.resolve(e);return d.promise})}function aa(a){return n(a,
function(a){a=L(a,d);return n(U(L(a,function(a){return n(a,G,G)})),function(){return a})})}var R=!1;try{throw Error();}catch(N){R=!!N.stack}var O=g(),W,G=function(){},y=function(){function a(){for(;e.next;){e=e.next;var b=e.task;e.task=void 0;var l=e.domain;l&&(e.domain=void 0,l.enter());try{b()}catch(q){if(f)throw l&&l.exit(),setTimeout(a,0),l&&l.enter(),q;setTimeout(function(){throw q;},0)}l&&l.exit()}d=!1}var e={task:void 0,next:null},b=e,d=!1,l=void 0,f=!1;y=function(a){b=b.next={task:a,domain:f&&
process.domain,next:null};d||(d=!0,l())};if("undefined"!==typeof process&&process.nextTick)f=!0,l=function(){process.nextTick(a)};else if("function"===typeof setImmediate)l="undefined"!==typeof window?setImmediate.bind(window,a):function(){setImmediate(a)};else if("undefined"!==typeof MessageChannel){var q=new MessageChannel;q.port1.onmessage=function(){l=h;q.port1.onmessage=a;a()};var h=function(){q.port2.postMessage(0)},l=function(){setTimeout(a,0);h()}}else l=function(){setTimeout(a,0)};return y}(),
K=Function.call,z=f(Array.prototype.slice),X=f(Array.prototype.reduce||function(a,e){var b=0,d=this.length;if(1===arguments.length){do{if(b in this){e=this[b++];break}if(++b>=d)throw new TypeError;}while(1)}for(;b<d;b++)b in this&&(e=a(e,this[b],b));return e}),J=f(Array.prototype.indexOf||function(a){for(var e=0;e<this.length;e++)if(this[e]===a)return e;return-1}),L=f(Array.prototype.map||function(a,e){var b=this,d=[];X(b,function(l,f,q){d.push(a.call(e,f,q,b))},void 0);return d}),V=Object.create||
function(a){function e(){}e.prototype=a;return new e},T=f(Object.prototype.hasOwnProperty),E=Object.keys||function(a){var e=[],b;for(b in a)T(a,b)&&e.push(b);return e},F=f(Object.prototype.toString),D;D="undefined"!==typeof ReturnValue?ReturnValue:function(a){this.value=a};d.resolve=d;d.nextTick=y;d.longStackSupport=!1;d.defer=a;a.prototype.makeNodeResolver=function(){var a=this;return function(e,b){e?a.reject(e):2<arguments.length?a.resolve(z(arguments,1)):a.resolve(b)}};d.Promise=h;d.promise=h;
h.race=m;h.all=U;h.reject=t;h.resolve=d;d.passByCopy=function(a){return a};b.prototype.passByCopy=function(){return this};d.join=function(a,e){return d(a).join(e)};b.prototype.join=function(a){return d([this,a]).spread(function(a,e){if(a===e)return a;throw Error("Can't join: not the same: "+a+" "+e);})};d.race=m;b.prototype.race=function(){return this.then(d.race)};d.makePromise=b;b.prototype.toString=function(){return"[object Promise]"};b.prototype.then=function(e,b,l){function f(a){try{return"function"===
typeof e?e(a):a}catch(b){return t(b)}}function q(a){if("function"===typeof b){p(a,h);try{return b(a)}catch(e){return t(e)}}return t(a)}var h=this,g=a(),k=!1;y(function(){h.promiseDispatch(function(a){k||(k=!0,g.resolve(f(a)))},"when",[function(a){k||(k=!0,g.resolve(q(a)))}])});h.promiseDispatch(void 0,"when",[void 0,function(a){var e,b=!1;try{e="function"===typeof l?l(a):a}catch(f){if(b=!0,d.onerror)d.onerror(f);else throw f;}b||g.notify(e)}]);return g.promise};d.when=n;b.prototype.thenResolve=function(a){return this.then(function(){return a})};
d.thenResolve=function(a,e){return d(a).thenResolve(e)};b.prototype.thenReject=function(a){return this.then(function(){throw a;})};d.thenReject=function(a,e){return d(a).thenReject(e)};d.nearer=r;d.isPromise=u;d.isPromiseAlike=v;d.isPending=function(a){return u(a)&&"pending"===a.inspect().state};b.prototype.isPending=function(){return"pending"===this.inspect().state};d.isFulfilled=function(a){return!u(a)||"fulfilled"===a.inspect().state};b.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state};
d.isRejected=function(a){return u(a)&&"rejected"===a.inspect().state};b.prototype.isRejected=function(){return"rejected"===this.inspect().state};var M=[],P=[],I=!0;d.resetUnhandledRejections=w;d.getUnhandledReasons=function(){return M.slice()};d.stopUnhandledRejectionTracking=function(){w();I=!1};w();d.reject=t;d.fulfill=e;d.master=function(a){return b({isDef:function(){}},function(e,b){return Z(a,e,b)},function(){return d(a).inspect()})};d.spread=A;b.prototype.spread=function(a,e){return this.all().then(function(e){return a.apply(void 0,
e)},e)};d.async=function(a){return function(){function e(a,f){var q;if("undefined"===typeof StopIteration){try{q=b[a](f)}catch(h){return t(h)}return q.done?q.value:n(q.value,d,l)}try{q=b[a](f)}catch(g){return"[object StopIteration]"===F(g)||g instanceof D?g.value:t(g)}return n(q,d,l)}var b=a.apply(this,arguments),d=e.bind(e,"next"),l=e.bind(e,"throw");return d()}};d.spawn=function(a){d.done(d.async(a)())};d["return"]=function(a){throw new D(a);};d.promised=function(a){return function(){return A([this,
U(arguments)],function(e,b){return a.apply(e,b)})}};d.dispatch=Z;b.prototype.dispatch=function(e,b){var d=this,l=a();y(function(){d.promiseDispatch(l.resolve,e,b)});return l.promise};d.get=function(a,e){return d(a).dispatch("get",[e])};b.prototype.get=function(a){return this.dispatch("get",[a])};d.set=function(a,e,b){return d(a).dispatch("set",[e,b])};b.prototype.set=function(a,e){return this.dispatch("set",[a,e])};d.del=d["delete"]=function(a,e){return d(a).dispatch("delete",[e])};b.prototype.del=
b.prototype["delete"]=function(a){return this.dispatch("delete",[a])};d.mapply=d.post=function(a,e,b){return d(a).dispatch("post",[e,b])};b.prototype.mapply=b.prototype.post=function(a,e){return this.dispatch("post",[a,e])};d.send=d.mcall=d.invoke=function(a,e){return d(a).dispatch("post",[e,z(arguments,2)])};b.prototype.send=b.prototype.mcall=b.prototype.invoke=function(a){return this.dispatch("post",[a,z(arguments,1)])};d.fapply=function(a,e){return d(a).dispatch("apply",[void 0,e])};b.prototype.fapply=
function(a){return this.dispatch("apply",[void 0,a])};d["try"]=d.fcall=function(a){return d(a).dispatch("apply",[void 0,z(arguments,1)])};b.prototype.fcall=function(){return this.dispatch("apply",[void 0,z(arguments)])};d.fbind=function(a){var e=d(a),b=z(arguments,1);return function(){return e.dispatch("apply",[this,b.concat(z(arguments))])}};b.prototype.fbind=function(){var a=this,e=z(arguments);return function(){return a.dispatch("apply",[this,e.concat(z(arguments))])}};d.keys=function(a){return d(a).dispatch("keys",
[])};b.prototype.keys=function(){return this.dispatch("keys",[])};d.all=U;b.prototype.all=function(){return U(this)};d.allResolved=function(a,e,b){return function(){"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(e+" is deprecated, use "+b+" instead.",Error("").stack);return a.apply(a,arguments)}}(aa,"allResolved","allSettled");b.prototype.allResolved=function(){return aa(this)};d.allSettled=function(a){return d(a).allSettled()};b.prototype.allSettled=function(){return this.then(function(a){return U(L(a,
function(a){function e(){return a.inspect()}a=d(a);return a.then(e,e)}))})};d.fail=d["catch"]=function(a,e){return d(a).then(void 0,e)};b.prototype.fail=b.prototype["catch"]=function(a){return this.then(void 0,a)};d.progress=function(a,e){return d(a).then(void 0,void 0,e)};b.prototype.progress=function(a){return this.then(void 0,void 0,a)};d.fin=d["finally"]=function(a,e){return d(a)["finally"](e)};b.prototype.fin=b.prototype["finally"]=function(a){a=d(a);return this.then(function(e){return a.fcall().then(function(){return e})},
function(e){return a.fcall().then(function(){throw e;})})};d.done=function(a,e,b,l){return d(a).done(e,b,l)};b.prototype.done=function(a,e,b){var l=function(a){y(function(){p(a,f);if(d.onerror)d.onerror(a);else throw a;})},f=a||e||b?this.then(a,e,b):this;"object"===typeof process&&process&&process.domain&&(l=process.domain.bind(l));f.then(void 0,l)};d.timeout=function(a,e,b){return d(a).timeout(e,b)};b.prototype.timeout=function(e,b){var d=a(),l=setTimeout(function(){d.reject(Error(b||"Timed out after "+
e+" ms"))},e);this.then(function(a){clearTimeout(l);d.resolve(a)},function(a){clearTimeout(l);d.reject(a)},d.notify);return d.promise};d.delay=function(a,e){void 0===e&&(e=a,a=void 0);return d(a).delay(e)};b.prototype.delay=function(e){return this.then(function(b){var d=a();setTimeout(function(){d.resolve(b)},e);return d.promise})};d.nfapply=function(a,e){return d(a).nfapply(e)};b.prototype.nfapply=function(e){var b=a();e=z(e);e.push(b.makeNodeResolver());this.fapply(e).fail(b.reject);return b.promise};
d.nfcall=function(a){var e=z(arguments,1);return d(a).nfapply(e)};b.prototype.nfcall=function(){var e=z(arguments),b=a();e.push(b.makeNodeResolver());this.fapply(e).fail(b.reject);return b.promise};d.nfbind=d.denodeify=function(e){var b=z(arguments,1);return function(){var l=b.concat(z(arguments)),f=a();l.push(f.makeNodeResolver());d(e).fapply(l).fail(f.reject);return f.promise}};b.prototype.nfbind=b.prototype.denodeify=function(){var a=z(arguments);a.unshift(this);return d.denodeify.apply(void 0,
a)};d.nbind=function(e,b){var l=z(arguments,2);return function(){var f=l.concat(z(arguments)),q=a();f.push(q.makeNodeResolver());d(function(){return e.apply(b,arguments)}).fapply(f).fail(q.reject);return q.promise}};b.prototype.nbind=function(){var a=z(arguments,0);a.unshift(this);return d.nbind.apply(void 0,a)};d.nmapply=d.npost=function(a,e,b){return d(a).npost(e,b)};b.prototype.nmapply=b.prototype.npost=function(e,b){var d=z(b||[]),l=a();d.push(l.makeNodeResolver());this.dispatch("post",[e,d]).fail(l.reject);
return l.promise};d.nsend=d.nmcall=d.ninvoke=function(e,b){var l=z(arguments,2),f=a();l.push(f.makeNodeResolver());d(e).dispatch("post",[b,l]).fail(f.reject);return f.promise};b.prototype.nsend=b.prototype.nmcall=b.prototype.ninvoke=function(e){var b=z(arguments,1),d=a();b.push(d.makeNodeResolver());this.dispatch("post",[e,b]).fail(d.reject);return d.promise};d.nodeify=function(a,e){return d(a).nodeify(e)};b.prototype.nodeify=function(a){if(a)this.then(function(e){y(function(){a(null,e)})},function(e){y(function(){a(e)})});
else return this};var S=g();return d});
define("enketo-js/widgets",["text!enketo-config","enketo-js/support","q","jquery"],function(f,p,k,g){var d,a,h,m,b,n,r,u=[];a=function(a){for(var b,d,f=k.defer(),e=[],q=0;q<a.widgets.length;q++)b="text!"+a.widgets[q].substr(0,a.widgets[q].lastIndexOf("/")+1)+"config.json",e.push(b);require(e,function(){for(var e=0;e<arguments.length;e++)d=JSON.parse(arguments[e]),d.path=a.widgets[e],u.push(d);f.resolve(u)});return f.promise};h=function(a,b){return b?"form"===b?d:a.find(b):g()};m=function(a){u.forEach(function(d){var l;
d.options=d.options||{};d.options.touch=p.touch;if(!d.selector&&null!==d.selector)return console.error("widget configuration has no acceptable selector property",d);l=h(a,d.selector);l.length&&(d.load||(d.load=b(d)),d.load.then(function(a){a.name&&(l[a.name](a.options),n(a,l),r(a,l))}))})};b=function(a){var b=k.defer();require([a.path],function(d){a.name=d;b.resolve(a)});return b.promise};n=function(a,b){if(0<b.length)d.on("changelanguage",function(){b[a.name]("update")})};r=function(a,b){if(0<b.length&&
"select"===b.prop("nodeName").toLowerCase())d.on("changeoption","select",function(){g(this)[a.name]("update")})};return{init:function(b){d=g("form.or");b=b||d;a(JSON.parse(f)).then(function(a){m(b)})},enable:function(a){for(var b,d,f=0;f<u.length;f++)b=u[f],b.name&&(d=h(a,b.selector),d[b.name]("enable"))},disable:function(a){for(var b,d,f=0;f<u.length;f++)b=u[f],b.name&&(d=h(a,b.selector),d[b.name]("disable"))},destroy:function(a){for(var b,d,f=0;f<u.length;f++)b=u[f],b.name&&(d=h(a,b.selector),d[b.name]("destroy"))}}});
(function(f){"function"===typeof define&&define.amd&&define.amd.jQuery?define("jquery.touchswipe",["jquery"],f):f(jQuery)})(function(f){function p(d){!d||void 0!==d.allowPageScroll||void 0===d.swipe&&void 0===d.swipeStatus||(d.allowPageScroll="none");void 0!==d.click&&void 0===d.tap&&(d.tap=d.click);d||(d={});d=f.extend({},f.fn.swipe.defaults,d);return this.each(function(){var a=f(this),h=a.data("TouchSwipe");h||(h=new k(this,d),a.data("TouchSwipe",h))})}function k(d,a){function h(e){if(!0!==x.data("TouchSwipe_intouch")&&
!(0<f(e.target).closest(a.excludedElements,x).length)){var b=e.originalEvent?e.originalEvent:e,d,l=g?b.touches[0]:b;B="start";g?C=b.touches.length:e.preventDefault();E=0;Y=F=null;P=M=D=0;I=1;S=0;e=[];for(var q=0;5>=q;q++)e.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});H=e;e={};e.left=y("left");e.right=y("right");e.up=y("up");e.down=y("down");ea=e;ga=da=0;if(!g||C===a.fingers||"all"===a.fingers||A()){if(O(0,l),fa=z(),2==C&&(O(1,b.touches[1]),M=P=K(H[0].start,H[1].start)),a.swipeStatus||a.pinchStatus)d=
w(b,B)}else d=!1;if(!1===d)return B="cancel",w(b,B),d;N(!0);return null}}function k(e){var b,d,l,q=e.originalEvent?e.originalEvent:e;if("end"!==B&&"cancel"!==B&&!R()){var h,t=W(g?q.touches[0]:q);ca=z();g&&(C=q.touches.length);B="move";2==C&&(0==M?(O(1,q.touches[1]),M=P=K(H[0].start,H[1].start)):(W(q.touches[1]),P=K(H[0].end,H[1].end),Y=1>I?"out":"in"),I=(P/M*1).toFixed(2),S=Math.abs(M-P));if(C===a.fingers||"all"===a.fingers||!g||A()){b=t.start;d=t.end;b=Math.atan2(d.y-b.y,b.x-d.x);b=Math.round(180*
b/Math.PI);0>b&&(b=360-Math.abs(b));b=F=45>=b&&0<=b?"left":360>=b&&315<=b?"left":135<=b&&225>=b?"right":45<b&&135>b?"down":"up";if("none"===a.allowPageScroll||A())e.preventDefault();else switch(d="auto"===a.allowPageScroll,b){case "left":(a.swipeLeft&&d||!d&&"horizontal"!=a.allowPageScroll)&&e.preventDefault();break;case "right":(a.swipeRight&&d||!d&&"horizontal"!=a.allowPageScroll)&&e.preventDefault();break;case "up":(a.swipeUp&&d||!d&&"vertical"!=a.allowPageScroll)&&e.preventDefault();break;case "down":(a.swipeDown&&
d||!d&&"vertical"!=a.allowPageScroll)&&e.preventDefault()}e=t.start;b=t.end;E=Math.round(Math.sqrt(Math.pow(b.x-e.x,2)+Math.pow(b.y-e.y,2)));D=ca-fa;e=F;b=E;b=Math.max(b,G(e));ea[e].distance=b;if(a.swipeStatus||a.pinchStatus)h=w(q,B);if(!a.triggerOnTouchEnd||a.triggerOnTouchLeave){e=!0;if(a.triggerOnTouchLeave){l=f(this);var n=l.offset();e=n.left;b=n.left+l.outerWidth();d=n.top;l=n.top+l.outerHeight();t=t.end;e=t.x>e&&t.x<b&&t.y>d&&t.y<l}!a.triggerOnTouchEnd&&e?B=v("move"):a.triggerOnTouchLeave&&
!e&&(B=v("end"));"cancel"!=B&&"end"!=B||w(q,B)}}else B="cancel",w(q,B);!1===h&&(B="cancel",w(q,B))}}function b(b){var d=b.originalEvent;if(g&&0<d.touches.length)return da=z(),ga=event.touches.length+1,!0;R()&&(C=ga);b.preventDefault();ca=z();D=ca-fa;e()?(B="cancel",w(d,B)):a.triggerOnTouchEnd||0==a.triggerOnTouchEnd&&"move"===B?(B="end",w(d,B)):!a.triggerOnTouchEnd&&a.tap?(B="end",l(d,B,"tap")):"move"===B&&(B="cancel",w(d,B));N(!1);return null}function n(){P=M=fa=ca=C=0;I=1;ga=da=0;N(!1)}function p(e){e=
e.originalEvent;a.triggerOnTouchLeave&&(B=v("end"),w(e,B))}function u(){x.unbind(J,h);x.unbind("touchcancel",n);x.unbind(L,k);x.unbind(V,b);T&&x.unbind(T,p);N(!1)}function v(b){var d=b,l=a.maxTimeThreshold?D>=a.maxTimeThreshold?!1:!0:!0,f=t(),q=e();!l||q?d="cancel":!f||"move"!=b||a.triggerOnTouchEnd&&!a.triggerOnTouchLeave?!f&&"end"==b&&a.triggerOnTouchLeave&&(d="cancel"):d="end";return d}function w(e,b){var d=void 0;Z()&&U()||U()?d=l(e,b,"swipe"):(q()&&A()||A())&&!1!==d&&(d=l(e,b,"pinch"));aa()&&
a.doubleTap&&!1!==d?d=l(e,b,"doubletap"):D>a.longTapThreshold&&10>E&&a.longTap&&!1!==d?d=l(e,b,"longtap"):!(1!==C&&g||!isNaN(E)&&0!==E)&&a.tap&&!1!==d&&(d=l(e,b,"tap"));"cancel"===b&&n(e);"end"===b&&(g?0==e.touches.length&&n(e):n(e));return d}function l(e,b,d){var l=void 0;if("swipe"==d){x.trigger("swipeStatus",[b,F||null,E||0,D||0,C]);if(a.swipeStatus&&(l=a.swipeStatus.call(x,e,b,F||null,E||0,D||0,C),!1===l))return!1;if("end"==b&&Z()){x.trigger("swipe",[F,E,D,C]);if(a.swipe&&(l=a.swipe.call(x,e,
F,E,D,C),!1===l))return!1;switch(F){case "left":x.trigger("swipeLeft",[F,E,D,C]);a.swipeLeft&&(l=a.swipeLeft.call(x,e,F,E,D,C));break;case "right":x.trigger("swipeRight",[F,E,D,C]);a.swipeRight&&(l=a.swipeRight.call(x,e,F,E,D,C));break;case "up":x.trigger("swipeUp",[F,E,D,C]);a.swipeUp&&(l=a.swipeUp.call(x,e,F,E,D,C));break;case "down":x.trigger("swipeDown",[F,E,D,C]),a.swipeDown&&(l=a.swipeDown.call(x,e,F,E,D,C))}}}if("pinch"==d){x.trigger("pinchStatus",[b,Y||null,S||0,D||0,C,I]);if(a.pinchStatus&&
(l=a.pinchStatus.call(x,e,b,Y||null,S||0,D||0,C,I),!1===l))return!1;if("end"==b&&q())switch(Y){case "in":x.trigger("pinchIn",[Y||null,S||0,D||0,C,I]);a.pinchIn&&(l=a.pinchIn.call(x,e,Y||null,S||0,D||0,C,I));break;case "out":x.trigger("pinchOut",[Y||null,S||0,D||0,C,I]),a.pinchOut&&(l=a.pinchOut.call(x,e,Y||null,S||0,D||0,C,I))}}if("tap"==d){if("cancel"===b||"end"===b)clearTimeout(ha),a.doubleTap&&!aa()?(ba=z(),ha=setTimeout(f.proxy(function(){ba=null;x.trigger("tap",[e.target]);a.tap&&(l=a.tap.call(x,
e,e.target))},this),a.doubleTapThreshold)):(ba=null,x.trigger("tap",[e.target]),a.tap&&(l=a.tap.call(x,e,e.target)))}else if("doubletap"==d){if("cancel"===b||"end"===b)clearTimeout(ha),ba=null,x.trigger("doubletap",[e.target]),a.doubleTap&&(l=a.doubleTap.call(x,e,e.target))}else"longtap"!=d||"cancel"!==b&&"end"!==b||(clearTimeout(ha),ba=null,x.trigger("longtap",[e.target]),a.longTap&&(l=a.longTap.call(x,e,e.target)));return l}function t(){var e=!0;null!==a.threshold&&(e=E>=a.threshold);return e}function e(){var e=
!1;null!==a.cancelThreshold&&null!==F&&(e=G(F)-E>=a.cancelThreshold);return e}function q(){var e=C===a.fingers||"all"===a.fingers||!g,b=0!==H[0].end.x,d;d=null!==a.pinchThreshold?S>=a.pinchThreshold:!0;return e&&b&&d}function A(){return!!(a.pinchStatus||a.pinchIn||a.pinchOut)}function Z(){var b=a.maxTimeThreshold?D>=a.maxTimeThreshold?!1:!0:!0,d=t(),l=C===a.fingers||"all"===a.fingers||!g,f=0!==H[0].end.x;return!e()&&f&&l&&d&&b}function U(){return!!(a.swipe||a.swipeStatus||a.swipeLeft||a.swipeRight||
a.swipeUp||a.swipeDown)}function aa(){if(null==ba)return!1;var e=z();return!!a.doubleTap&&e-ba<=a.doubleTapThreshold}function R(){var e=!1;da&&z()-da<=a.fingerReleaseThreshold&&(e=!0);return e}function N(a){!0===a?(x.bind(L,k),x.bind(V,b),T&&x.bind(T,p)):(x.unbind(L,k,!1),x.unbind(V,b,!1),T&&x.unbind(T,p,!1));x.data("TouchSwipe_intouch",!0===a)}function O(a,e){H[a].identifier=void 0!==e.identifier?e.identifier:0;H[a].start.x=H[a].end.x=e.pageX||e.clientX;H[a].start.y=H[a].end.y=e.pageY||e.clientY;
return H[a]}function W(a){var e=void 0!==a.identifier?a.identifier:0;a:{for(var b=0;b<H.length;b++)if(H[b].identifier==e){e=H[b];break a}e=void 0}e.end.x=a.pageX||a.clientX;e.end.y=a.pageY||a.clientY;return e}function G(a){if(ea[a])return ea[a].distance}function y(a){return{direction:a,distance:0}}function K(a,e){var b=Math.abs(a.x-e.x),d=Math.abs(a.y-e.y);return Math.round(Math.sqrt(b*b+d*d))}function z(){return(new Date).getTime()}var X=g||!a.fallbackToMouseEvents,J=X?"touchstart":"mousedown",L=
X?"touchmove":"mousemove",V=X?"touchend":"mouseup",T=X?null:"mouseleave",E=0,F=null,D=0,M=0,P=0,I=1,S=0,Y=0,ea=null,x=f(d),B="start",C=0,H=null,fa=0,ca=0,da=0,ga=0,ba=0,ha=null;try{x.bind(J,h),x.bind("touchcancel",n)}catch(ia){f.error("events not supported "+J+",touchcancel on jQuery.swipe")}this.enable=function(){x.bind(J,h);x.bind("touchcancel",n);return x};this.disable=function(){u();return x};this.destroy=function(){u();x.data("TouchSwipe",null);return x};this.option=function(e,b){if(void 0!==
a[e]){if(void 0===b)return a[e];a[e]=b}else f.error("Option "+e+" does not exist on jQuery.swipe.options");return null}}var g="ontouchstart"in window;f.fn.swipe=function(d){var a=f(this),h=a.data("TouchSwipe");if(h&&"string"===typeof d){if(h[d])return h[d].apply(this,Array.prototype.slice.call(arguments,1));f.error("Method "+d+" does not exist on jQuery.swipe")}else if(!(h||"object"!==typeof d&&d))return p.apply(this,arguments);return a};f.fn.swipe.defaults={fingers:1,threshold:75,cancelThreshold:null,
pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"label, button, input, select, textarea, a, .noSwipe"};f.fn.swipe.phases={PHASE_START:"start",PHASE_MOVE:"move",
PHASE_END:"end",PHASE_CANCEL:"cancel"};f.fn.swipe.directions={LEFT:"left",RIGHT:"right",UP:"up",DOWN:"down",IN:"in",OUT:"out"};f.fn.swipe.pageScroll={NONE:"none",HORIZONTAL:"horizontal",VERTICAL:"vertical",AUTO:"auto"};f.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:"all"}});
define("enketo-js/Form","enketo-js/FormModel enketo-js/widgets jquery enketo-js/plugins enketo-js/extend jquery.touchswipe".split(" "),function(f,p,k){return function(g,d){function a(a){this.$=n=k(a);this.$nonRepeats={}}var h,m,b,n,r,u,v,w=[];this.init=function(){r=k(g).clone().appendTo("<original></original>");h=new f(d);w=w.concat(h.init());b=new a(g);u=0<k(g).find(".or-repeat").length;b.init();window.scrollTo&&window.scrollTo(0,0);return w};this.ex=function(a,b,e,d,f){return h.evaluate(a,b,e,d,
f)};this.getModel=function(){return h};this.getInstanceID=function(){return h.getInstanceID()};this.getInstanceName=function(){return h.getInstanceName()};this.getView=function(){return b};this.getEncryptionKey=function(){return b.$.data("base64rsapublickey")};this.getDataStr=function(){return h.getStr()};this.getRecordName=function(){return b.recordName.get()};this.setRecordName=function(a){return b.recordName.set(a)};this.setEditStatus=function(a){return b.editStatus.set(a)};this.getEditStatus=
function(){return b.editStatus.get()};this.getSurveyName=function(){return n.find("#form-title").text()};this.resetHTML=this.resetView=function(){k("#form-languages").remove();n.replaceWith(r)};this.validate=function(){return b.validateAll()};this.isValid=function(){return b.isValid()};v=function(a,b,e,d,f){var g,m="",p=a.match(/jr:choice-name\(([^,]+),\s?'(.*?)'\)/);return p?(g=h.evaluate(p[1],b,e,d,f),b=p[2].trim(),b=n.find('[name="'+b+'"]'),0<b.length&&"select"===b.prop("nodeName").toLowerCase()?
m=b.find('[value="'+g+'"]').text():0<b.length&&"input"===b.prop("nodeName").toLowerCase()&&(m=b.filter(function(){return k(this).attr("value")===g}).siblings(".option-label.active").text()),a.replace(p[0],'"'+m+'"')):a};a.prototype.init=function(){var a=this;if("undefined"===typeof h||!(h instanceof f))return console.error("variable data needs to be defined as instance of FormModel");this.preloads.init(this);this.grosslyViolateStandardComplianceByIgnoringCertainCalcs();this.calcUpdate();this.langs.init();
this.repeat.init(this);this.itemsetUpdate();this.setAllVals();p.init();this.branchUpdate();this.pages.init();this.outputUpdate();this.setEventHandlers();this.editStatus.set(!1);setTimeout(function(){a.progress.update()},0)};a.prototype.pages={active:!1,$current:[],$activePages:k(),init:function(){if(n.hasClass("pages")){var a=n.find(".note, .question, .trigger, .or-appearance-field-list").filter(function(){return 0===k(this).parent().closest(".or-appearance-field-list").length}).attr("role","page");
if(1<a.length||a.eq(0).hasClass("or-repeat"))this.$formFooter=k(".form-footer"),this.$btnFirst=this.$formFooter.find(".first-page"),this.$btnPrev=this.$formFooter.find(".previous-page"),this.$btnNext=this.$formFooter.find(".next-page"),this.$btnLast=this.$formFooter.find(".last-page"),this.updateAllActive(a),this.toggleButtons(0),this.setButtonHandlers(),this.setRepeatHandlers(),this.setBranchHandlers(),this.setSwipeHandlers(),this.active=!0;this.flipToFirst();n.show()}},setButtonHandlers:function(){var a=
this;this.$btnFirst.off(".pagemode").on("click.pagemode",function(){a.flipToFirst();return!1});this.$btnPrev.off(".pagemode").on("click.pagemode",function(){a.prev();return!1});this.$btnNext.off(".pagemode").on("click.pagemode",function(){a.next();return!1});this.$btnLast.off(".pagemode").on("click.pagemode",function(){a.flipToLast();return!1})},setSwipeHandlers:function(){var a=this;k(".main").swipe("destroy").swipe({allowPageScroll:"vertical",threshold:75,swipeLeft:function(){a.next()},swipeRight:function(){a.prev()}})},
setRepeatHandlers:function(){var a=this;n.off("addrepeat.pagemode").on("addrepeat.pagemode",function(b){a.updateAllActive();k(b.target).removeClass("current contains-current").find(".current").removeClass("current");a.flipToPageContaining(k(b.target))}).off("removerepeat.pagemode").on("removerepeat.pagemode",function(b){0===a.$current.closest("html").length&&(a.updateAllActive(),a.flipToPageContaining(k(b.target)))})},setBranchHandlers:function(){var a=this;n.off("changebranch.pagemode").on("changebranch.pagemode",
function(){a.updateAllActive();a.toggleButtons()})},getCurrent:function(){return this.$current},updateAllActive:function(a){a=a||k('.or [role="page"]');this.$activePages=a.filter(function(){return 0===k(this).closest(".disabled").length})},getAllActive:function(){return this.$activePages},getPrev:function(a){return this.$activePages[a-1]},getNext:function(a){return this.$activePages[a+1]},getCurrentIndex:function(){return this.$activePages.index(this.$current)},next:function(){var a,b;this.updateAllActive();
b=this.getCurrentIndex();(a=this.getNext(b))&&this.flipTo(a,b+1)},prev:function(){var a,b;this.updateAllActive();b=this.getCurrentIndex();(a=this.getPrev(b))&&this.flipTo(a,b-1)},setToCurrent:function(a){a=k(a);a.addClass("current hidden");this.$current=a.removeClass("hidden").parentsUntil(".or",".or-group, .or-group-data, .or-repeat").addClass("contains-current").end()},flipTo:function(a,b){0<this.$current.length&&1===this.$current.closest("html").length?this.$current[0]!==a&&(this.$current.removeClass("current fade-out").parentsUntil(".or",
".or-group, .or-group-data, .or-repeat").removeClass("contains-current"),this.setToCurrent(a),this.focusOnFirstQuestion(a),this.toggleButtons(b)):(this.setToCurrent(a),this.focusOnFirstQuestion(a),this.toggleButtons(b));window.scrollTo&&window.scrollTo(0,0);k(a).trigger("pageflip.enketo")},flipToFirst:function(){this.updateAllActive();this.flipTo(this.$activePages[0])},flipToLast:function(){this.updateAllActive();this.flipTo(this.$activePages.last()[0])},flipToPageContaining:function(a){var b;b=a.closest('[role="page"]');
b=0===b.length?a.find('[role="page"]'):b;this.flipTo(b[0])},focusOnFirstQuestion:function(a){k(a).find(".question:not(.disabled)").filter(function(){return 0===k(this).parentsUntil(".or",".disabled").length}).eq(0).find("input, select, textarea").eq(0).trigger("fakefocus")},toggleButtons:function(a){var b=a||this.getCurrentIndex();a=this.getNext(b);b=this.getPrev(b);this.$btnNext.add(this.$btnLast).toggleClass("disabled",!a);this.$btnPrev.add(this.$btnFirst).toggleClass("disabled",!b);this.$formFooter.toggleClass("end",
!a)}};a.prototype.input={getWrapNodes:function(a){return"fieldset"===this.getInputType(a.eq(0))?a:a.closest(".question, .note")},getProps:function(a){return 1!==a.length?console.error("getProps(): no input node provided or multiple"):{path:this.getName(a),ind:this.getIndex(a),inputType:this.getInputType(a),xmlType:this.getXmlType(a),constraint:this.getConstraint(a),calculation:this.getCalculation(a),relevant:this.getRelevant(a),val:this.getVal(a),required:this.isRequired(a),enabled:this.isEnabled(a),
multiple:this.isMultiple(a)}},getInputType:function(a){var b;if(1!==a.length)return"";b=a.prop("nodeName").toLowerCase();return"input"===b?0<a.attr("type").length?a.attr("type").toLowerCase():console.error("<input> node has no type"):"select"===b?"select":"textarea"===b?"textarea":"fieldset"===b||"section"===b?"fieldset":console.error("unexpected input node type provided")},getConstraint:function(a){return a.attr("data-constraint")},getRelevant:function(a){return a.attr("data-relevant")},getCalculation:function(a){return a.attr("data-calculate")},
getXmlType:function(a){return 1!==a.length?console.error("getXMLType(): no input node provided or multiple"):a.attr("data-type-xml")},getName:function(a){return 1!==a.length?console.error("getName(): no input node provided or multiple"):a.attr("data-name")||a.attr("name")||console.error("input node has no name")},getIndex:function(a){var b,e,d;if(1!==a.length)return console.error("getIndex(): no input node provided or multiple");b=this.getInputType(a);e=this.getName(a);d=this.getWrapNodes(a);return("radio"===
b&&e!==a.attr("name")?this.getWrapNodes(n.find('[data-name="'+e+'"]')):"fieldset"===b&&a.hasClass("or-repeat")?this.getWrapNodes(n.find('.or-repeat[name="'+e+'"]')):"fieldset"===b&&a.hasClass("or-group")?this.getWrapNodes(n.find('.or-group[name="'+e+'"]')):this.getWrapNodes(n.find('[name="'+e+'"]'))).index(d)},isMultiple:function(a){return"checkbox"===this.getInputType(a)||void 0!==a.attr("multiple")?!0:!1},isEnabled:function(a){return!(a.prop("disabled")||0<a.parentsUntil(".or",".disabled").length)},
isRequired:function(a){return void 0!==a.attr("required")&&0===a.parentsUntil(".or",".or-appearance-label").length},getVal:function(a){var b,e=[],d;if(1!==a.length)return console.error("getVal(): no inputNode provided or multiple");b=this.getInputType(a);d=this.getName(a);return"radio"===b?this.getWrapNodes(a).find("input:checked").val()||"":"checkbox"===b?(this.getWrapNodes(a).find('input[name="'+d+'"]:checked').each(function(){e.push(k(this).val())}),e):a.val()?k.isArray(a.val())?a.val().join(" ").trim():
a.val().trim():""},setVal:function(a,b,e){var d,f;b=b||0;if("radio"===this.getInputType(n.find('[data-name="'+a+'"]').eq(0)))a=this.getWrapNodes(n.find('[data-name="'+a+'"]')).eq(b).find('input[value="'+e+'"]'),a.prop("checked",!0);else{d=this.getWrapNodes(n.find('[name="'+a+'"]').eq(b)).find('[name="'+a+'"]');f=this.getInputType(d.eq(0));if("file"===f)return d.eq(0).attr("data-loaded-file-name",e),!1;if("date"===f||"datetime"===f)e=h.node(a,b).convert(e,f);!0===this.isMultiple(d.eq(0))&&(e=e.split(" "));
d.is("[readonly]")&&d.toggleClass("has-value",!!e);d.val(e)}}};a.prototype.setAllVals=function(a,b){var e,d,f,g=this,n=a&&a.attr("name")?a.attr("name"):null;h.node(n,"undefined"!==typeof b?b:null).get().find("*").filter(function(){var a=k(this);return 0===a.children().length&&a.text()}).each(function(){var a=k(this);try{f=a.text(),d=a.getXPath("instance"),e=h.node(d).get().index(this),g.input.setVal(d,e,f)}catch(b){console.error(b),w.push("Could not load input field value with name: "+d+" and value: "+
f)}})};a.prototype.langs={init:function(){var a,b=this,e=n.find("#form-languages").attr("data-default-lang"),d=k(".form-language-selector");k("#form-languages").detach().appendTo(d);e&&""!==e||(e=k("#form-languages option").eq(0).attr("value"));k("#form-languages").val(e);2>k("#form-languages option").length||(d.removeClass("hide"),k("#form-languages").change(function(e){a=k(this).val();e.preventDefault();b.setAll(a)}))},setAll:function(a){var b=this;k("#form-languages option").removeClass("active");
k(this).addClass("active");n.find("[lang]").removeClass("active").filter('[lang="'+a+'"], [lang=""]').filter(function(){var a=k(this);return!a.hasClass("or-form-short")||a.hasClass("or-form-short")&&0===a.siblings(".or-form-long").length}).addClass("active");n.find("select").each(function(){b.setSelect(k(this))});n.trigger("changelanguage")},setSelect:function(a){var b,e,d;a.children("option").not('[value=""]').each(function(){var a=k(this);e=a.text();b=a.attr("value");d=a.parent("select").siblings(".or-option-translations").children('.active[data-option-value="'+
b+'"]').text().trim();d="undefined"!==typeof d&&0<d.length?d:e;a.text(d)})}};a.prototype.editStatus={set:function(a){a&&a!==n.data("edited")&&n.trigger("edited.enketo");n.data("edited",a)},get:function(){return!!n.data("edited")}};a.prototype.recordName={set:function(a){n.attr("name",a)},get:function(){return n.attr("name")}};a.prototype.getNodesToUpdate=function(a,b,e){var d;d=null;var f=[],h=this;e=e||{};b=b||"";this.$nonRepeats[a]||(this.$nonRepeats[a]=n.find(b+"["+a+"]").parentsUntil(".or",".calculation, .question, .note, .trigger").filter(function(){return 0===
k(this).closest(".or-repeat").length}));"undefined"!==typeof e.repeatPath&&0<=e.repeatIndex&&(d=n.find('.or-repeat[name="'+e.repeatPath+'"]').eq(e.repeatIndex));d=d?this.$nonRepeats[a].add(d):n;e.nodes&&0!==e.nodes.length?(e.nodes.forEach(function(e){f=f.concat(h.getQuerySelectorsForLogic(b,a,e))}),f=f.concat(h.getQuerySelectorsForLogic(b,a,"*"))):f=f.concat([b+"["+a+"]"]);return d.find(f.join())};a.prototype.getQuerySelectorsForLogic=function(a,b,e){return[a+"["+b+'*="/'+e+' "]',a+"["+b+'*="/'+e+
')"]',a+"["+b+'*="/'+e+',"]',a+"["+b+'$="/'+e+'"]',a+"["+b+'*="/'+e+']"]']};a.prototype.branchUpdate=function(a){var b,e,d;function f(a){return!a.hasClass("disabled")&&!a.hasClass("pre-init")}function g(a){var e=a.prop("nodeName").toLowerCase(),b=a.hasClass("pre-init");if(b||f(a))y=!0,a.addClass("disabled"),b?a.removeClass("pre-init"):(a.clearInputs("change"),p.disable(a),a.find(".invalid-required, .invalid-constraint").find("input, select, textarea").each(function(){w.setValid(k(this))})),"label"===
e?a.children("input, select, textarea").prop("disabled",!0):"fieldset"===e?a.prop("disabled",!0):a.find("fieldset, input, select, textarea").prop("disabled",!0)}var m,r,R,N,O,W={},G=[],y=!1,w=this,z=0,v;a=this.getNodesToUpdate("data-relevant","",a);v=u&&0<n.find(".or-repeat.clone").length?!0:!1;a.each(function(){var a=k(this);if(-1===k.inArray(a.attr("name"),G)&&(m=a.closest(".or-branch"),!m.parent().closest(".disabled").length))if(d=e=b=void 0,O=null,b=w.input.getRelevant(a),e=w.input.getName(a),
1!==m.length)0===a.parentsUntil(".or","#or-calculated-items").length&&console.error("could not find branch node for ",k(this));else if(R=v&&0<m.parentsUntil(".or",".or-repeat").length?!0:!1,d=(N=v&&0<m.parentsUntil(".or",".or-repeat.clone").length?!0:!1)?w.input.getIndex(a):0,-1===b.indexOf("..")&&(O=R?b+"__"+e.substring(0,e.lastIndexOf("/"))+"__"+d:b),O&&"undefined"!==typeof W[O]?r=W[O]:(r=h.evaluate(b,"boolean",e,d),z++,W[O]=r),R||G.push(k(this).attr("name")),a=m,!0===r){var l;f(a)||(y=!0,a.removeClass("disabled pre-init"),
p.enable(a),l=a.prop("nodeName").toLowerCase(),"label"===l?a.children("input, select, textarea").prop("disabled",!1):"fieldset"===l?(a.prop("disabled",!1),a.find('*:not(.or-branch) input[type="file"]:not([data-relevant])').prop("disabled",!0).prop("disabled",!1)):a.find("fieldset, input, select, textarea").prop("disabled",!1))}else g(a)});y&&this.$.trigger("changebranch")};a.prototype.itemsetUpdate=function(a){var b,e,d,f=this,g={};a=this.getNodesToUpdate("data-items-path",".itemset-template",a);
b=u&&0<n.find(".or-repeat.clone").length?!0:!1;a.each(function(){var a,l,n,m,p,r,u,y,w,z,v,J,L,V,T,E;u=k(this);u.parentsUntil(".or",".or-branch").parentsUntil(".or",".disabled").length||(y={},w=u.data(),z=u.prop("nodeName").toLowerCase(),v="label"===z?u.children("input").eq(0):u.parent("select"),J=u.closest("label, select").siblings(".itemset-labels"),L=u.attr("data-items-path"),V=J.attr("data-label-type"),T=J.attr("data-label-ref"),E=J.attr("data-value-ref"),p=f.input.getName(v),e=b&&0<v.parentsUntil(".or",
".or-repeat").length?!0:!1,m=(d=b&&0<v.parentsUntil(".or",".or-repeat.clone").length?!0:!1)?f.input.getIndex(v):0,"undefined"!==typeof g[L]?m=g[L]:(m=k(h.evaluate(L,"nodes",p,m,!0)),e||(g[L]=m)),y.length=m.length,y.text=m.text(),y.length===w.length&&y.text===w.text)||(u.data(y),u.closest(".question").clearInputs("change").find(z).not(u).remove(),u.parent("select").siblings(".or-option-translations").empty(),m.each(function(){var e=k(this);r=e.children(T).text();a=k("<root/>");u.clone().appendTo(a).removeClass("itemset-template").addClass("itemset").removeAttr("data-items-path");
l="itext"===V&&0<J.find('[data-itext-id="'+r+'"]').length?J.find('[data-itext-id="'+r+'"]').clone():k('<span class="option-label active" lang="">'+r+"</span>");n=e.children(E).text();a.find("[value]").attr("value",n);"label"===z?(a.find("input").after(l),J.before(a.find(":first"))):"option"===z&&(1===l.length&&a.find("option").text(l.text()),l.attr("data-option-value",n).attr("data-itext-id","").appendTo(J.siblings(".or-option-translations")),u.siblings().addBack().last().after(a.find(":first")))}),
"select"===v.prop("nodeName").toLowerCase()&&(f.langs.setSelect(v),v.trigger("changeoption")))})};a.prototype.outputUpdate=function(a){var b,e,d,f,g,m,p,r,N={},v="",w=this;a=this.getNodesToUpdate("data-value",".or-output",a);e=u&&0<n.find(".or-repeat.clone").length;a.each(function(){m=k(this);m.closest(".or-branch").parent().closest(".disabled").length||(b=m.attr("data-value"),g=m.closest(".question, .note, .or-group").find("[name]").eq(0),p=g.length?w.input.getName(g):void 0,r=(f=(d=e&&0<m.parentsUntil(".or",
".or-repeat").length)&&0<m.parentsUntil(".or",".or-repeat.clone").length)?w.input.getIndex(g):0,"undefined"!==typeof N[b]?v=N[b]:(v=h.evaluate(b,"string",p,r,!0),d||(N[b]=v)),m.text!==v&&m.text(v))})};a.prototype.grosslyViolateStandardComplianceByIgnoringCertainCalcs=function(){var a=n.find('[name$="/meta/instanceID"][data-calculate]');0<a.length&&a.removeAttr("data-calculate")};a.prototype.calcUpdate=function(a){var b,e=this;a=a||{};b=this.getNodesToUpdate("data-calculate","",a);b=b.add(this.getNodesToUpdate("data-relevant",
"[data-calculate]",a));b.each(function(){function b(a){t=v(t,"string",m,a);d=u&&t?h.evaluate(t,"string",m,a):"";f.setIndex(a);f.setVal(d,r,p);e.input.setVal(m,a,d)}var d,f,g,n,m,t,p,r,u;g=k(this);m=e.input.getName(g);n=-1!==m.lastIndexOf("/")?m.substring(m.lastIndexOf("/")+1):m;t=e.input.getCalculation(g);p=e.input.getXmlType(g);r=e.input.getConstraint(g);u=(g=e.input.getRelevant(g))?h.evaluate(g,"boolean",m):!0;f=h.node(m);g=f.get();1<g.length&&a.repeatPath&&-1!==m.indexOf(a.repeatPath)?(n=h.node(a.repeatPath,
a.repeatIndex).get().find(n),n=k(g).index(n),b(n)):1===g.length?b(0):g.each(function(a){b(a)})})};a.prototype.preloads={init:function(a){var b,e,d,f,g,m,p,r,u,v=this;n.find("#or-preload-items input").each(function(){u=k(this);p=a.input.getProps(u);b=u.attr("data-preload").toLowerCase();e=u.attr("data-preload-params").toLowerCase();"undefined"!==typeof v[b]?(m=h.node(p.path,p.index),f=m.getVal()[0],g=v[b]({param:e,curVal:f,dataNode:m}),m.setVal(g,null,p.xmlType)):console.log('Preload "'+b+'" not supported. May or may not be a big deal.')});
h.node("/*/meta/*").get().each(function(){b=null;d=k(this).prop("nodeName");m=h.node("/*/meta/"+d);f=m.getVal()[0];if(0===n.find('#or-preload-items input[name$="/meta/'+d+'"][data-preload]').length)switch(d){case "instanceID":b="instance";r="string";e="";break;case "timeStart":b="timestamp";r="datetime";e="start";break;case "timeEnd":b="timestamp";r="datetime";e="end";break;case "deviceID":b="property";r="string";e="deviceid";break;case "userID":b="property",r="string",e="username"}b&&m.setVal(v[b]({param:e,
curVal:f,dataNode:m}),null,r)})},timestamp:function(a){var b;return"start"===a.param?0<a.curVal.length?a.curVal:h.evaluate("now()","string"):"end"===a.param?(n.on("beforesave",function(){b=h.evaluate("now()","string");a.dataNode.setVal(b,null,"datetime")}),h.evaluate("now()","string")):"error - unknown timestamp parameter"},date:function(a){var b,e;return 0===a.curVal.length?(b=new Date(h.evaluate("today()","string")),a=b.getFullYear().toString().pad(4),e=(b.getMonth()+1).toString().pad(2),b=b.getDate().toString().pad(2),
a+"-"+e+"-"+b):a.curVal},property:function(a){var b,e;b=function(a,e,b,d){if(m)return m[a];e=document.cookie.split("; ");m={};for(d=e.length-1;0<=d;d--)b=e[d].split("="),b[1]=decodeURIComponent(b[1]),"s:"===b[1].substr(0,2)&&(b[1]=b[1].slice(2),b[1]=b[1].slice(0,b[1].lastIndexOf("."))),m[b[0]]=decodeURIComponent(b[1]);return m[a]};if(0===a.curVal.length){e="no "+a.param+" property in enketo";switch(a.param){case "deviceid":a=b("__enketo_meta_deviceid")||"Error: could not determine deviceID";break;
case "username":a=b("__enketo_meta_uid");break;default:a=e}return a}return a.curVal},context:function(a){return 0===a.curVal.length?"application"===a.param?"enketo":a.param+" not supported in enketo":a.curVal},patient:function(a){return 0===a.curVal.length?"patient preload not supported in enketo":a.curVal},user:function(a){return 0===a.curVal.length?"user preload item not supported in enketo yet":a.curVal},uid:function(a){return 0===a.curVal.length?"no uid yet in enketo":a.curVal},instance:function(a){a=
0<a.curVal.length?a.curVal:h.evaluate('concat("uuid:", uuid())',"string");n.data({instanceID:a});return a}};a.prototype.repeat={init:function(a){var b,e,d,f,g,m,p,r=this;this.formO=a;n.find(".or-repeat").prepend('<span class="repeat-number"></span>');n.find(".or-repeat:not([data-repeat-fixed])").append('<div class="repeat-buttons"><button type="button" class="btn btn-default repeat"><i class="icon icon-plus"> </i></button><button type="button" disabled class="btn btn-default remove"><i class="icon icon-minus"> </i></button></div>');
n.on("click","button.repeat:enabled",function(){r.clone(k(this).closest(".or-repeat"));return!1});n.on("click","button.remove:enabled",function(){r.remove(k(this).closest(".or-repeat.clone"));return!1});g=function(a,l){e=a.attr("data-repeat-count")||"";b=0<e.length?parseInt(h.node(e).getVal()[0],10):0;p=n.find('.or-repeat[name="'+a.attr("name")+'"]').index(a);m=h.node(a.attr("name"),p).get();d=m.siblings(m.prop("nodeName")).addBack().length;f=b>d?b:d;1<f&&r.clone(a.siblings().addBack().last(),f-1,
!0);a.siblings(".or-repeat").addBack().find(".or-repeat").filter(function(){return k(this).parentsUntil(".or",".or-repeat").length===l}).each(function(){g(k(this),l+1)})};n.find(".or-repeat").filter(function(){return 0===k(this).parentsUntil(".or",".or-repeat").length}).each(function(){g(k(this),1)})},clone:function(a,b,e){var d,f,g,m,r=this;b=b||1;if(1!==a.length)return console.error("Nothing to clone"),!1;d=a.siblings(".or-repeat");f=a.hasClass("clone")?d.not(".clone").eq(0):a;g=f.clone(!0,!0);
m=f.attr("name");g.addClass("clone").find(".clone").remove();g.find(".invalid-required, .invalid-constraint").find("input, select, textarea").each(function(){r.formO.setValid(k(this))});f=n.find('.or-repeat[name="'+m+'"]').index(a);g.clearInputs("");for(b+=f;f<b;f++)g.find(".option-wrapper").each(this.fixRadioNames),e||p.destroy(g),g.insertAfter(a),0<m.length&&0<=f&&h.cloneRepeat(m,f),g.trigger("addrepeat",f+1),e?r.formO.calcUpdate({repeatPath:m,repeatIndex:f+1}):p.init(g),d=d.add(g),g=g.clone();
a=d.add(a).add(d.find(".or-repeat"));this.numberRepeats(a);this.toggleButtons(a);return!0},remove:function(a){var b=this,e=a.prev(".or-repeat"),d=a.attr("name"),f=n.find('.or-repeat[name="'+d+'"]').index(a),g=a.siblings(".or-repeat");a.hide(600,function(){a.remove();b.numberRepeats(g);b.toggleButtons(g);e.trigger("removerepeat");h.node(d,f).remove()})},fixRadioNames:function(a,b){k(b).find('input[type="radio"]').attr("name",Math.floor(1E7*Math.random()+1))},toggleButtons:function(a){var b,e;a=a&&
0!==a.length?a:n;a.each(function(){b=k(this);e=b.siblings(".or-repeat").addBack();e.children(".repeat-buttons").find("button.repeat, button.remove").prop("disabled",!0);e.last().children(".repeat-buttons").find("button.repeat").prop("disabled",!1);e.children(".repeat-buttons").find("button.remove").not(":first").prop("disabled",!1)})},numberRepeats:function(a){a.each(function(){var a,b,d,f=k(this);0===f.prev(".or-repeat").length&&(a=k(this).siblings(".or-repeat"),b=a.length+1,1<b?(f.find(".repeat-number").text("1"),
d=2,a.each(function(){k(this).find(".repeat-number").eq(0).text(d);d++})):f.find(".repeat-number").eq(0).empty())})}};a.prototype.setEventHandlers=function(){var a=this;n.attr("onsubmit","return false;");n.on("blur",'input:not([type="text"], [type="radio"], [type="checkbox"])',function(){var a=k(this);"undefined"!==typeof a.prop("validity").badInput&&a.prop("validity").badInput&&a.val("")});n.on("change.file validate","input:not(.ignore), select:not(.ignore), textarea:not(.ignore)",function(b){var e,
d,f=k(this),g=a.input.getName(f),m=a.input.getInputType(f),p=a.input.getXmlType(f),r=a.input.isEnabled(f);e=a.input.getConstraint(f);var u=a.input.getVal(f),v=a.input.isRequired(f),w,G=function(){d||(w=a.input.getIndex(f),d=h.node(g,w));return d};0<u.length&&"file"===m&&f[0].files[0]&&0<f[0].files[0].size&&(u=f[0].files[0].name);"validate"===b.type?e=r&&"hidden"!==m?e||"string"!==p&&"select"!==p&&"select1"!==p&&"binary"!==p?G().validate(e,p):!0:!0:(e=G().setVal(u,e,p),e=!1!==e||"geotrace"!==p&&"geoshape"!==
p?e:null);!1===!(r&&"hidden"!==m&&v&&0===G().getVal()[0].length)?(a.setValid(f,"constraint"),"validate"===b.type&&a.setInvalid(f,"required")):(a.setValid(f,"required"),"undefined"!==typeof e&&!1===e?a.setInvalid(f,"constraint"):null!==e&&a.setValid(f,"constraint"));"change"===b.type&&n.trigger("valuechange.enketo")});n.on("focus fakefocus","input:not(.ignore), select:not(.ignore), textarea:not(.ignore)",function(b){a.progress.update(b.target)});n.on("focus blur fakefocus fakeblur","input:not(.ignore), select:not(.ignore), textarea:not(.ignore)",
function(b){var e=k(this),d=a.input.getProps(e),f=e.closest(".question"),g=f.find("legend").eq(0),h=f.hasClass("invalid-required")||f.hasClass("invalid-constraint"),e=0<e.parentsUntil(".or",".or-appearance-list-nolabel").length,m=f.find(".required-subtle"),n=k('<span class="required-subtle" style="color: transparent;">Required</span>');if("focusin"===b.type||"fakefocus"===b.type)f.addClass("focus"),d.required&&0===m.length&&!e&&(m=k(n),0<g.length?g.append(m):m.insertBefore(this),h||m.show(function(){k(this).removeAttr("style")}));
else if("focusout"===b.type||"fakeblur"===b.type)f.removeClass("focus"),d.required&&0<d.val.length?m.remove():h||m.removeAttr("style")});h.$.on("dataupdate",function(b,e){a.calcUpdate(e);a.branchUpdate(e);a.outputUpdate(e);a.itemsetUpdate(e);a.editStatus.set(!0)});n.on("addrepeat",function(b,e){var d=k(b.target);a.setAllVals(d,e);a.calcUpdate({repeatPath:d.attr("name"),repeatIndex:e});a.progress.update()});n.on("removerepeat",function(){a.progress.update()});n.on("changelanguage",function(){a.outputUpdate()})};
a.prototype.setValid=function(a,b){var e=b?"invalid-"+b:"invalid-constraint invalid-required";this.input.getWrapNodes(a).removeClass(e)};a.prototype.setInvalid=function(a,b){b=b||"constraint";this.input.getWrapNodes(a).addClass("invalid-"+b).find(".required-subtle").attr("style","color: transparent;")};a.prototype.validateAll=function(){var a,b=this;n.find("fieldset:disabled input, fieldset:disabled select, fieldset:disabled textarea, input:disabled, select:disabled, textarea:disabled").each(function(){b.setValid(k(this))});
n.find(".question").each(function(){k(this).find("input:not(.ignore):not(:disabled), select:not(.ignore):not(:disabled), textarea:not(.ignore):not(:disabled)").eq(0).trigger("validate")});a=n.find(".invalid-required, .invalid-constraint").eq(0);0<a.length&&window.scrollTo&&(this.pages.active&&this.pages.flipToPageContaining(a),window.scrollTo(0,a.offset().top-50));return 0===a.length};a.prototype.progress={status:0,lastChanged:null,$all:null,updateTotal:function(){this.$all=n.find(".question").not(".disabled").filter(function(){return 0===
k(this).parentsUntil(".or",".disabled").length})},update:function(a){this.$all&&a||this.updateTotal();this.lastChanged=a||this.lastChanged;a=Math.round(100*(this.$all.index(k(this.lastChanged).closest(".question"))+1)/this.$all.length);0<a&&a!==this.status&&(this.status=a,n.trigger("progressupdate.enketo",a))},get:function(){return this.status}};a.prototype.isValid=function(){return 0<n.find(".invalid-required, .invalid-constraint").length?!1:!0};a.prototype.addPageBreaks=function(){}}});
define("enketo-js/Widget",["jquery"],function(f){var p=function(f,g,d){this.element=f;this.options=g||{};this.namespace=this.namespace||"somewidget";this.options.touch="undefined"!==typeof this.options.touch?this.options.touch:!1;this.event=d||null};p.prototype={destroy:function(k){f(k).removeData(this.namespace).off("."+this.namespace).show().next(".widget").remove()},disable:function(){},enable:function(){},update:function(){}};return p});
define("enketo-widget/note/notewidget",["enketo-js/Widget","jquery","enketo-js/plugins"],function(f,p){function k(g,d){this.namespace="notewidget";f.call(this,g,d);this._init()}k.prototype=Object.create(f.prototype);k.prototype.constructor=k;k.prototype._init=function(){var f=p(this.element);f.find(".question-label").markdownToHtml().end().find("[readonly]").addClass("ignore");f.is(".note")&&!f.next().is(".note")&&f.addClass("last-of-class")};k.prototype.destroy=function(f){};p.fn.notewidget=function(f,
d){return this.each(function(){var a=p(this),h=a.data("notewidget");f=f||{};if(!h&&"object"===typeof f)a.data("notewidget",new k(this,f,d));else if(h&&"string"===typeof f)h[f](this)})};return"notewidget"});define("text!enketo-widget/note/config.json",[],function(){return'{\n    "stylesheet": "note.scss",\n    "selector": ".note",\n    "options": {}\n}\n'});define("text!enketo-widget/select-desktop/config.json",[],function(){return'{\n    "stylesheet": "selectpicker.scss",\n    "selector": "select:not(#form-languages)",\n    "options": {}\n}\n'});
define("enketo-widget/select-desktop/selectpicker",["jquery","enketo-js/Widget"],function(f,p){function k(g,d,a){this.namespace="desktopSelectpicker";p.call(this,g,d);a&&(a.stopPropagation(),a.preventDefault());this.$picker=null;this.noneSelectedText=d.noneSelectedText||"none selected";this.lengthmax=d.maxlength||15;this.multiple="undefined"!==typeof f(g).attr("multiple")&&!1!==f(g).attr("multiple");this._init()}k.prototype=Object.create(p.prototype);k.prototype.constructor=k;k.prototype._init=function(){var g=
this._getTemplate(),d=f(this.element);d.css("display","none");g=this._createLi(g);this.$picker=g.insertAfter(d);this.$picker.find("> a").addClass(this.selectClass);this._clickListener();this._focusListener()};k.prototype._getTemplate=function(){return'<div class="btn-group bootstrap-select widget clearfix"><button type="button" class="btn btn-default dropdown-toggle clearfix" data-toggle="dropdown"><span class="selected">__SELECTED_OPTIONS</span><span class="caret"></span></button><ul class="dropdown-menu" role="menu">__ADD_LI</ul></div>'};
k.prototype._createLi=function(g){var d=[],a="",h=this.multiple?'type="checkbox"':'type="radio" name="'+1E5*Math.random()+'"',m,b;f(this.element).find("option").each(function(){d.push({label:f(this).text(),selected:f(this).is(":selected"),value:f(this).attr("value")})});if(0<d.length){g=g.replace("__SELECTED_OPTIONS",this._createSelectedStr());for(var k=0;k<d.length;k++)d[k].value&&(m=d[k].selected?' checked="checked"':"",b=d[k].selected&&!this.multiple?'class="active"':"",a+="<li "+b+'><a class="option-wrapper" tabindex="-1" href="#"><label><input class="ignore" '+
h+m+'value="'+d[k].value+'" /><span class="option-label">'+d[k].label+"</span></label></a></li>")}g=g.replace("__ADD_LI",a);return f(g)};k.prototype._createSelectedStr=function(){var g,d=[];f(this.element).find("option:selected").each(function(){0<f(this).attr("value").length&&d.push(f(this).text())});if(0===d.length)return this.noneSelectedText;g=d.join(", ");return g.length>this.lengthmax?d.length+" selected":g};k.prototype._clickListener=function(){var g=this;this.$picker.on("click","li:not(.disabled)",
function(d){d.preventDefault();var a=f(this),h=a.find("input"),k=f(g.element),b=k.find('option[value="'+h.val()+'"]'),n=b.is(":selected");g.multiple?d.stopPropagation():(g.$picker.find("li").removeClass("active"),b.siblings("option").prop("selected",!1),g.$picker.find("input").prop("checked",!1));n?(a.removeClass("active"),h.prop("checked",!1),b.prop("selected",!1)):(g.multiple||a.addClass("active"),h.prop("checked",!0),b.prop("selected",!0));g.$picker.find(".selected").html(g._createSelectedStr());
k.trigger("change")})};k.prototype._focusListener=function(){var g=this;this.$picker.on("shown.bs.dropdown",function(){f(g.element).trigger("fakefocus");return!0}).on("hidden.bs.dropdown",function(){f(g.element).trigger("fakeblur");return!0})};k.prototype.disable=function(){this.$picker.find("li").addClass("disabled")};k.prototype.enable=function(){this.$picker.find("li").removeClass("disabled")};k.prototype.update=function(){this.$picker.remove();this._init()};f.fn.desktopSelectpicker=function(g,
d){g=g||{};return this.each(function(){var a=f(this),h=a.data("desktopSelectpicker");if(!h&&"object"===typeof g&&!g.touch)a.data("desktopSelectpicker",new k(this,g,d));else if(h&&"string"===typeof g)h[g](this)})};+function(f){function d(b){f(".dropdown-backdrop").remove();f("[data-toggle=dropdown]").each(function(){var d=a(f(this)),h={relatedTarget:this};d.hasClass("open")&&(d.trigger(b=f.Event("hide.bs.dropdown",h)),b.isDefaultPrevented()||d.removeClass("open").trigger("hidden.bs.dropdown",h))})}
function a(a){var d=a.attr("data-target");d||(d=(d=a.attr("href"))&&/#[A-Za-z]/.test(d)&&d.replace(/.*(?=#[^\s]*$)/,""));return(d=d&&f(d))&&d.length?d:a.parent()}var h=function(a){f(a).on("click.bs.dropdown",this.toggle)};h.prototype.toggle=function(b){var h=f(this);if(!h.is(".disabled, :disabled")){var k=a(h);b=k.hasClass("open");d();if(!b){if("ontouchstart"in document.documentElement&&!k.closest(".navbar-nav").length)f('<div class="dropdown-backdrop"/>').insertAfter(f(this)).on("click",d);var m=
{relatedTarget:this};k.trigger(b=f.Event("show.bs.dropdown",m));if(b.isDefaultPrevented())return;k.toggleClass("open").trigger("shown.bs.dropdown",m);h.focus()}return!1}};h.prototype.keydown=function(b){if(/(38|40|27)/.test(b.keyCode)){var d=f(this);b.preventDefault();b.stopPropagation();if(!d.is(".disabled, :disabled")){var h=a(d),k=h.hasClass("open");if(!k||k&&27===b.keyCode)return 27===b.which&&h.find("[data-toggle=dropdown]").focus(),d.click();d=h.find("[role=menu] li:not(.divider):visible a, [role=listbox] li:not(.divider):visible a");
d.length&&(h=d.index(d.filter(":focus")),38===b.keyCode&&0<h&&h--,40===b.keyCode&&h<d.length-1&&h++,~h||(h=0),d.eq(h).focus())}}};var k=f.fn.dropdown;f.fn.dropdown=function(a){return this.each(function(){var d=f(this),k=d.data("bs.dropdown");k||d.data("bs.dropdown",k=new h(this));"string"===typeof a&&k[a].call(d)})};f.fn.dropdown.Constructor=h;f.fn.dropdown.noConflict=function(){f.fn.dropdown=k;return this};f(document).on("click.bs.dropdown.data-api",d).on("click.bs.dropdown.data-api",".dropdown form",
function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api","[data-toggle=dropdown]",h.prototype.toggle).on("keydown.bs.dropdown.data-api","[data-toggle=dropdown], [role=menu], [role=listbox]",h.prototype.keydown)}(jQuery);return"desktopSelectpicker"});define("text!enketo-widget/select-mobile/config.json",[],function(){return'{\n    "stylesheet": "selectpicker.scss",\n    "selector": "select[multiple]",\n    "options": {}\n}\n'});
define("enketo-widget/select-mobile/selectpicker",["jquery","enketo-js/Widget"],function(f,p){function k(f,d,a){this.namespace="mobileSelectpicker";p.call(this,f,d);this._init()}k.prototype=Object.create(p.prototype);k.prototype.constructor=k;k.prototype._init=function(){var g=this;f(this.element).on("change.mobileSelectpicker",function(){g._showSelectedValues();return!0});this._showSelectedValues()};k.prototype._showSelectedValues=function(){var g,d=[];g=f(this.element);var a=0<g.next(".widget").length?
g.next(".widget"):f('<span class="widget mobileselect"></span>').insertAfter(g),h=f.isArray(g.val())?g.val():[g.val()];for(g=0;g<h.length;g++)d.push(f(this).find('option[value="'+h[g]+'"]').text());a.text(h.join(", "))};f.fn.mobileSelectpicker=function(g,d){g=g||{};return this.each(function(){var a=f(this),h=a.data("mobileSelectpicker");!h&&"object"===typeof g&&g.touch&&a.data("mobileSelectpicker",h=new k(this,g,d));if(h&&"string"===typeof g)h[g](this)})};return"mobileSelectpicker"});
define("text!enketo-widget/table/config.json",[],function(){return'{\n    "stylesheet": "tablewidget.scss",\n    "selector": null,\n    "options": {}\n}\n'});define("enketo-widget/table/tablewidget",function(){});define("text!enketo-widget/radio/config.json",[],function(){return'{\n    "stylesheet": "radiopicker.scss",\n    "selector": "form",\n    "options": {}\n}\n'});
define("enketo-widget/radio/radiopicker",["enketo-js/Widget","jquery","enketo-js/plugins"],function(f,p){function k(d,a){this.namespace="radiopicker";f.call(this,d,a);this._init()}var g=null;k.prototype=Object.create(f.prototype);k.prototype.constructor=k;k.prototype._init=function(){this._setDelegatedHandlers()};k.prototype._setDelegatedHandlers=function(){var d,a,f=p(this.element);f.on("click",'input[type="radio"]:checked',function(a){p(this).parent("label").siblings().removeAttr("data-checked").end().attr("data-checked",
"true")});f.on("click",'input[type="checkbox"]',function(f){a=p(this);d=a.parent("label");a.is(":checked")?d.attr("data-checked","true"):d.removeAttr("data-checked")});f.on("click",'input[type="radio"], input[type="checkbox"]',function(a){g&&g.trigger("fakeblur");g=p(this).trigger("fakefocus")});f.on("focusin fakefocus",'input:not([type="radio"], [type="checkbox"]), textarea, select',function(a){g&&g.trigger("fakeblur");g=null});f.find('input[type="radio"]:checked, input[type="checkbox"]:checked').parent("label").attr("data-checked",
"true");f.on("click",'[data-checked]>input[type="radio"]:not(.no-unselect)',function(a){p(this).prop("checked",!1).trigger("change").parent().removeAttr("data-checked")})};k.prototype.destroy=function(d){};p.fn.radiopicker=function(d,a){var f=p(this),g=f.data("radiopicker");d=d||{};if(!g&&"object"===typeof d)f.data("radiopicker",new k(f[0],d,a));else if(g&&"string"===typeof d)g[d](this);return this};return"radiopicker"});define("text!enketo-widget/date/config.json",[],function(){return'{\n    "stylesheet": "datepicker-extended.scss",\n    "selector": "input[type=\\"date\\"]:not([readonly])",\n    "options": {}\n}\n'});
(function(f,p){function k(){return new Date(Date.UTC.apply(Date,arguments))}function g(){var a=new Date;return k(a.getFullYear(),a.getMonth(),a.getDate())}function d(a){return function(){return this[a].apply(this,arguments)}}function a(a,b){function d(a,b){return b.toLowerCase()}var h=f(a).data(),g={},k,l=new RegExp("^"+b.toLowerCase()+"([A-Z])");b=new RegExp("^"+b.toLowerCase());for(var m in h)b.test(m)&&(k=m.replace(l,d),g[k]=h[m]);return g}function h(a){var b={};if(!l[a]&&(a=a.split("-")[0],!l[a]))return;
var d=l[a];f.each(w,function(a,e){e in d&&(b[e]=d[e])});return b}var m=f(window),b=function(){var a={get:function(a){return this.slice(a)[0]},contains:function(a){a=a&&a.valueOf();for(var b=0,e=this.length;b<e;b++)if(this[b].valueOf()===a)return b;return-1},remove:function(a){this.splice(a,1)},replace:function(a){a&&(f.isArray(a)||(a=[a]),this.clear(),this.push.apply(this,a))},clear:function(){this.length=0},copy:function(){var a=new b;a.replace(this);return a}};return function(){var b=[];b.push.apply(b,
arguments);f.extend(b,a);return b}}(),n=function(a,d){this.dates=new b;this.viewDate=g();this.focusDate=null;this._process_options(d);this.element=f(a);this.isInline=!1;this.isInput=this.element.is("input");this.hasInput=(this.component=this.element.is(".date")?this.element.find(".add-on, .input-group-addon, .btn"):!1)&&this.element.find("input").length;this.component&&0===this.component.length&&(this.component=!1);this.picker=f(t.template);this._buildEvents();this._attachEvents();this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):
this.picker.addClass("datepicker-dropdown dropdown-menu");this.o.rtl&&this.picker.addClass("datepicker-rtl");this.viewMode=this.o.startView;this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(a,b){return parseInt(b)+1});this._allow_update=!1;this.setStartDate(this._o.startDate);this.setEndDate(this._o.endDate);this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled);this.fillDow();this.fillMonths();this._allow_update=!0;this.update();this.showMode();this.isInline&&this.show()};
n.prototype={constructor:n,_process_options:function(a){this._o=f.extend({},this._o,a);a=this.o=f.extend({},this._o);var b=a.language;l[b]||(b=b.split("-")[0],l[b]||(b=v.language));a.language=b;switch(a.startView){case 2:case "decade":a.startView=2;break;case 1:case "year":a.startView=1;break;default:a.startView=0}switch(a.minViewMode){case 1:case "months":a.minViewMode=1;break;case 2:case "years":a.minViewMode=2;break;default:a.minViewMode=0}a.startView=Math.max(a.startView,a.minViewMode);!0!==a.multidate&&
(a.multidate=Number(a.multidate)||!1,a.multidate=!1!==a.multidate?Math.max(0,a.multidate):1);a.multidateSeparator=String(a.multidateSeparator);a.weekStart%=7;a.weekEnd=(a.weekStart+6)%7;b=t.parseFormat(a.format);-Infinity!==a.startDate&&(a.startDate=a.startDate?a.startDate instanceof Date?this._local_to_utc(this._zero_time(a.startDate)):t.parseDate(a.startDate,b,a.language):-Infinity);Infinity!==a.endDate&&(a.endDate=a.endDate?a.endDate instanceof Date?this._local_to_utc(this._zero_time(a.endDate)):
t.parseDate(a.endDate,b,a.language):Infinity);a.daysOfWeekDisabled=a.daysOfWeekDisabled||[];f.isArray(a.daysOfWeekDisabled)||(a.daysOfWeekDisabled=a.daysOfWeekDisabled.split(/[,\s]*/));a.daysOfWeekDisabled=f.map(a.daysOfWeekDisabled,function(a){return parseInt(a,10)});var b=String(a.orientation).toLowerCase().split(/\s+/g),d=a.orientation.toLowerCase(),b=f.grep(b,function(a){return/^auto|left|right|top|bottom$/.test(a)});a.orientation={x:"auto",y:"auto"};if(d&&"auto"!==d)if(1===b.length)switch(b[0]){case "top":case "bottom":a.orientation.y=
b[0];break;case "left":case "right":a.orientation.x=b[0]}else d=f.grep(b,function(a){return/^left|right$/.test(a)}),a.orientation.x=d[0]||"auto",d=f.grep(b,function(a){return/^top|bottom$/.test(a)}),a.orientation.y=d[0]||"auto"},_events:[],_secondaryEvents:[],_applyEvents:function(a){for(var b=0,d,f,h;b<a.length;b++)d=a[b][0],2===a[b].length?(f=p,h=a[b][1]):3===a[b].length&&(f=a[b][1],h=a[b][2]),d.on(h,f)},_unapplyEvents:function(a){for(var b=0,d,f,h;b<a.length;b++)d=a[b][0],2===a[b].length?(h=p,
f=a[b][1]):3===a[b].length&&(h=a[b][1],f=a[b][2]),d.off(f,h)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:f.proxy(this.show,this),keyup:f.proxy(function(a){-1===f.inArray(a.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:f.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:f.proxy(this.show,this),keyup:f.proxy(function(a){-1===f.inArray(a.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:f.proxy(this.keydown,
this)}],[this.component,{click:f.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:f.proxy(this.show,this)}]];this._events.push([this.element,"*",{blur:f.proxy(function(a){this._focused_from=a.target},this)}],[this.element,{blur:f.proxy(function(a){this._focused_from=a.target},this)}]);this._secondaryEvents=[[this.picker,{click:f.proxy(this.click,this)}],[f(window),{resize:f.proxy(this.place,this)}],[f(document),{"mousedown touchstart":f.proxy(function(a){this.element.is(a.target)||
this.element.find(a.target).length||this.picker.is(a.target)||this.picker.find(a.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents();this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents();this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(a,b){var d=b||this.dates.get(-1),d=this._utc_to_local(d);
this.element.trigger({type:a,date:d,dates:f.map(this.dates,this._utc_to_local),format:f.proxy(function(a,b){0===arguments.length?(a=this.dates.length-1,b=this.o.format):"string"===typeof a&&(b=a,a=this.dates.length-1);b=b||this.o.format;var e=this.dates.get(a);return t.formatDate(e,b,this.o.language)},this)})},show:function(){this.isInline||this.picker.appendTo("body");this.picker.show();this.place();this._attachSecondaryEvents();this._trigger("show")},hide:function(){!this.isInline&&this.picker.is(":visible")&&
(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"))},remove:function(){this.hide();this._detachEvents();this._detachSecondaryEvents();this.picker.remove();delete this.element.data().datepicker;this.isInput||delete this.element.data().date},_utc_to_local:function(a){return a&&new Date(a.getTime()+
6E4*a.getTimezoneOffset())},_local_to_utc:function(a){return a&&new Date(a.getTime()-6E4*a.getTimezoneOffset())},_zero_time:function(a){return a&&new Date(a.getFullYear(),a.getMonth(),a.getDate())},_zero_utc_time:function(a){return a&&new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()))},getDates:function(){return f.map(this.dates,this._utc_to_local)},getUTCDates:function(){return f.map(this.dates,function(a){return new Date(a)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},
getUTCDate:function(){return new Date(this.dates.get(-1))},setDates:function(){var a=f.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,a);this._trigger("changeDate");this.setValue()},setUTCDates:function(){var a=f.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,f.map(a,this._utc_to_local));this._trigger("changeDate");this.setValue()},setDate:d("setDates"),setUTCDate:d("setUTCDates"),setValue:function(){var a=this.getFormattedDate();this.isInput?this.element.val(a).change():
this.component&&this.element.find("input").val(a).change()},getFormattedDate:function(a){a===p&&(a=this.o.format);var b=this.o.language;return f.map(this.dates,function(d){return t.formatDate(d,a,b)}).join(this.o.multidateSeparator)},setStartDate:function(a){this._process_options({startDate:a});this.update();this.updateNavArrows()},setEndDate:function(a){this._process_options({endDate:a});this.update();this.updateNavArrows()},setDaysOfWeekDisabled:function(a){this._process_options({daysOfWeekDisabled:a});
this.update();this.updateNavArrows()},place:function(){if(!this.isInline){var a=this.picker.outerWidth(),b=this.picker.outerHeight(),d=m.width(),h=m.height(),g=m.scrollTop(),k=parseInt(this.element.parents().filter(function(){return"auto"!==f(this).css("z-index")}).first().css("z-index"))+10,l=this.component?this.component.parent().offset():this.element.offset(),n=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),p=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),
r=l.left,t=l.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left");"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(r-=a-p)):(this.picker.addClass("datepicker-orient-left"),0>l.left?r-=l.left-10:l.left+a>d&&(r=d-a-10));a=this.o.orientation.y;"auto"===a&&(a=-g+l.top-b,h=g+h-(l.top+n+b),a=Math.max(a,h)===h?"top":"bottom");this.picker.addClass("datepicker-orient-"+
a);t="top"===a?t+n:t-(b+parseInt(this.picker.css("padding-top")));this.picker.css({top:t,left:r,zIndex:k})}},_allow_update:!0,update:function(){if(this._allow_update){var a=this.dates.copy(),b=[],d=!1;arguments.length?(f.each(arguments,f.proxy(function(a,e){e instanceof Date&&(e=this._local_to_utc(e));b.push(e)},this)),d=!0):(b=(b=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val())&&this.o.multidate?b.split(this.o.multidateSeparator):[b],delete this.element.data().date);
b=f.map(b,f.proxy(function(a){return t.parseDate(a,this.o.format,this.o.language)},this));b=f.grep(b,f.proxy(function(a){return a<this.o.startDate||a>this.o.endDate||!a},this),!0);this.dates.replace(b);this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate));d?this.setValue():b.length&&String(a)!==String(this.dates)&&this._trigger("changeDate");!this.dates.length&&
a.length&&this._trigger("clearDate");this.fill()}},fillDow:function(){var a=this.o.weekStart,b="<tr>";this.o.calendarWeeks&&(b+='<th class="cw">&nbsp;</th>',this.picker.find(".datepicker-days thead tr:first-child").prepend('<th class="cw">&nbsp;</th>'));for(;a<this.o.weekStart+7;)b+='<th class="dow">'+l[this.o.language].daysMin[a++%7]+"</th>";b+="</tr>";this.picker.find(".datepicker-days thead").append(b)},fillMonths:function(){for(var a="",b=0;12>b;)a+='<span class="month">'+l[this.o.language].monthsShort[b++]+
"</span>";this.picker.find(".datepicker-months td").html(a)},setRange:function(a){a&&a.length?this.range=f.map(a,function(a){return a.valueOf()}):delete this.range;this.fill()},getClassNames:function(a){var b=[],d=this.viewDate.getUTCFullYear(),h=this.viewDate.getUTCMonth(),g=new Date;a.getUTCFullYear()<d||a.getUTCFullYear()===d&&a.getUTCMonth()<h?b.push("old"):(a.getUTCFullYear()>d||a.getUTCFullYear()===d&&a.getUTCMonth()>h)&&b.push("new");this.focusDate&&a.valueOf()===this.focusDate.valueOf()&&
b.push("focused");this.o.todayHighlight&&a.getUTCFullYear()===g.getFullYear()&&a.getUTCMonth()===g.getMonth()&&a.getUTCDate()===g.getDate()&&b.push("today");-1!==this.dates.contains(a)&&b.push("active");(a.valueOf()<this.o.startDate||a.valueOf()>this.o.endDate||-1!==f.inArray(a.getUTCDay(),this.o.daysOfWeekDisabled))&&b.push("disabled");this.range&&(a>this.range[0]&&a<this.range[this.range.length-1]&&b.push("range"),-1!==f.inArray(a.valueOf(),this.range)&&b.push("selected"));return b},fill:function(){var a=
new Date(this.viewDate),b=a.getUTCFullYear(),d=a.getUTCMonth(),a=-Infinity!==this.o.startDate?this.o.startDate.getUTCFullYear():-Infinity,h=-Infinity!==this.o.startDate?this.o.startDate.getUTCMonth():-Infinity,g=Infinity!==this.o.endDate?this.o.endDate.getUTCFullYear():Infinity,m=Infinity!==this.o.endDate?this.o.endDate.getUTCMonth():Infinity,n=l[this.o.language].today||l.en.today||"",r=l[this.o.language].clear||l.en.clear||"",u;this.picker.find(".datepicker-days thead th.datepicker-switch").text(l[this.o.language].months[d]+
" "+b);this.picker.find("tfoot th.today").text(n).toggle(!1!==this.o.todayBtn);this.picker.find("tfoot th.clear").text(r).toggle(!1!==this.o.clearBtn);this.updateNavArrows();this.fillMonths();n=k(b,d-1,28);d=t.getDaysInMonth(n.getUTCFullYear(),n.getUTCMonth());n.setUTCDate(d);n.setUTCDate(d-(n.getUTCDay()-this.o.weekStart+7)%7);r=new Date(n);r.setUTCDate(r.getUTCDate()+42);for(var r=r.valueOf(),d=[],v;n.valueOf()<r;){if(n.getUTCDay()===this.o.weekStart&&(d.push("<tr>"),this.o.calendarWeeks)){v=new Date(+n+
(this.o.weekStart-n.getUTCDay()-7)%7*864E5);v=new Date(Number(v)+(11-v.getUTCDay())%7*864E5);var w=new Date(Number(w=k(v.getUTCFullYear(),0,1))+(11-w.getUTCDay())%7*864E5);d.push('<td class="cw">'+((v-w)/864E5/7+1)+"</td>")}v=this.getClassNames(n);v.push("day");if(this.o.beforeShowDay!==f.noop){var y=this.o.beforeShowDay(this._utc_to_local(n));y===p?y={}:"boolean"===typeof y?y={enabled:y}:"string"===typeof y&&(y={classes:y});!1===y.enabled&&v.push("disabled");y.classes&&(v=v.concat(y.classes.split(/\s+/)));
y.tooltip&&(u=y.tooltip)}v=f.unique(v);d.push('<td class="'+v.join(" ")+'"'+(u?' title="'+u+'"':"")+">"+n.getUTCDate()+"</td>");n.getUTCDay()===this.o.weekEnd&&d.push("</tr>");n.setUTCDate(n.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(d.join(""));var K=this.picker.find(".datepicker-months").find("th:eq(1)").text(b).end().find("span").removeClass("active");f.each(this.dates,function(a,e){e.getUTCFullYear()===b&&K.eq(e.getUTCMonth()).addClass("active")});(b<a||b>g)&&K.addClass("disabled");
b===a&&K.slice(0,h).addClass("disabled");b===g&&K.slice(m+1).addClass("disabled");d="";b=10*parseInt(b/10,10);u=this.picker.find(".datepicker-years").find("th:eq(1)").text(b+"-"+(b+9)).end().find("td");--b;w=f.map(this.dates,function(a){return a.getUTCFullYear()});for(m=-1;11>m;m++)h=["year"],-1===m?h.push("old"):10===m&&h.push("new"),-1!==f.inArray(b,w)&&h.push("active"),(b<a||b>g)&&h.push("disabled"),d+='<span class="'+h.join(" ")+'">'+b+"</span>",b+=1;u.html(d)},updateNavArrows:function(){if(this._allow_update){var a=
new Date(this.viewDate),b=a.getUTCFullYear(),a=a.getUTCMonth();switch(this.viewMode){case 0:-Infinity!==this.o.startDate&&b<=this.o.startDate.getUTCFullYear()&&a<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"});Infinity!==this.o.endDate&&b>=this.o.endDate.getUTCFullYear()&&a>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});
break;case 1:case 2:-Infinity!==this.o.startDate&&b<=this.o.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),Infinity!==this.o.endDate&&b>=this.o.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(a){a.preventDefault();a=f(a.target).closest("span, td, th");var b,d,h;if(1===a.length)switch(a[0].nodeName.toLowerCase()){case "th":switch(a[0].className){case "datepicker-switch":this.showMode(1);
break;case "prev":case "next":a=t.modes[this.viewMode].navStep*("prev"===a[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,a);this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,a),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case "today":a=new Date;a=k(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);this.showMode(-2);this._setDate(a,"linked"===this.o.todayBtn?null:"view");
break;case "clear":this.isInput?b=this.element:this.component&&(b=this.element.find("input")),b&&b.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()}break;case "span":a.is(".disabled")||(this.viewDate.setUTCDate(1),a.is(".month")?(h=1,d=a.parent().find("span").index(a),b=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(d),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(k(b,d,h))):(h=1,d=0,b=parseInt(a.text(),10)||0,this.viewDate.setUTCFullYear(b),
this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(k(b,d,h))),this.showMode(-1),this.fill());break;case "td":a.is(".day")&&!a.is(".disabled")&&(h=parseInt(a.text(),10)||1,b=this.viewDate.getUTCFullYear(),d=this.viewDate.getUTCMonth(),a.is(".old")?0===d?(d=11,--b):--d:a.is(".new")&&(11===d?(d=0,b+=1):d+=1),this._setDate(k(b,d,h)))}this.picker.is(":visible")&&this._focused_from&&f(this._focused_from).focus();delete this._focused_from},_toggle_multidate:function(a){var b=
this.dates.contains(a);a?-1!==b?this.dates.remove(b):this.dates.push(a):this.dates.clear();if("number"===typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(a,b){b&&"date"!==b||this._toggle_multidate(a&&new Date(a));b&&"view"!==b||(this.viewDate=a&&new Date(a));this.fill();this.setValue();this._trigger("changeDate");var d;this.isInput?d=this.element:this.component&&(d=this.element.find("input"));d&&d.change();!this.o.autoclose||b&&"date"!==b||this.hide()},
moveMonth:function(a,b){if(!a)return p;if(!b)return a;var d=new Date(a.valueOf()),f=d.getUTCDate(),h=d.getUTCMonth(),g=Math.abs(b),k;b=0<b?1:-1;if(1===g){if(g=-1===b?function(){return d.getUTCMonth()===h}:function(){return d.getUTCMonth()!==k},k=h+b,d.setUTCMonth(k),0>k||11<k)k=(k+12)%12}else{for(var l=0;l<g;l++)d=this.moveMonth(d,b);k=d.getUTCMonth();d.setUTCDate(f);g=function(){return k!==d.getUTCMonth()}}for(;g();)d.setUTCDate(--f),d.setUTCMonth(k);return d},moveYear:function(a,b){return this.moveMonth(a,
12*b)},dateWithinRange:function(a){return a>=this.o.startDate&&a<=this.o.endDate},keydown:function(a){if(this.picker.is(":not(:visible)"))27===a.keyCode&&this.show();else{var b=!1,d,f,h,k=this.focusDate||this.viewDate;switch(a.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide();a.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;d=37===a.keyCode?-1:1;a.ctrlKey?(f=this.moveYear(this.dates.get(-1)||g(),
d),h=this.moveYear(k,d),this._trigger("changeYear",this.viewDate)):a.shiftKey?(f=this.moveMonth(this.dates.get(-1)||g(),d),h=this.moveMonth(k,d),this._trigger("changeMonth",this.viewDate)):(f=new Date(this.dates.get(-1)||g()),f.setUTCDate(f.getUTCDate()+d),h=new Date(k),h.setUTCDate(k.getUTCDate()+d));this.dateWithinRange(f)&&(this.focusDate=this.viewDate=h,this.setValue(),this.fill(),a.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;d=38===a.keyCode?-1:1;a.ctrlKey?(f=
this.moveYear(this.dates.get(-1)||g(),d),h=this.moveYear(k,d),this._trigger("changeYear",this.viewDate)):a.shiftKey?(f=this.moveMonth(this.dates.get(-1)||g(),d),h=this.moveMonth(k,d),this._trigger("changeMonth",this.viewDate)):(f=new Date(this.dates.get(-1)||g()),f.setUTCDate(f.getUTCDate()+7*d),h=new Date(k),h.setUTCDate(k.getUTCDate()+7*d));this.dateWithinRange(f)&&(this.focusDate=this.viewDate=h,this.setValue(),this.fill(),a.preventDefault());break;case 13:k=this.focusDate||this.dates.get(-1)||
this.viewDate;this._toggle_multidate(k);b=!0;this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.setValue();this.fill();this.picker.is(":visible")&&(a.preventDefault(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(b){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var l;this.isInput?l=this.element:this.component&&(l=this.element.find("input"));l&&l.change()}}},
showMode:function(a){a&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+a)));this.picker.find(">div").hide().filter(".datepicker-"+t.modes[this.viewMode].clsName).css("display","block");this.updateNavArrows()}};var r=function(a,b){this.element=f(a);this.inputs=f.map(b.inputs,function(a){return a.jquery?a[0]:a});delete b.inputs;f(this.inputs).datepicker(b).bind("changeDate",f.proxy(this.dateUpdated,this));this.pickers=f.map(this.inputs,function(a){return f(a).data("datepicker")});
this.updateDates()};r.prototype={updateDates:function(){this.dates=f.map(this.pickers,function(a){return a.getUTCDate()});this.updateRanges()},updateRanges:function(){var a=f.map(this.dates,function(a){return a.valueOf()});f.each(this.pickers,function(b,d){d.setRange(a)})},dateUpdated:function(a){if(!this.updating){this.updating=!0;var b=f(a.target).data("datepicker").getUTCDate();a=f.inArray(a.target,this.inputs);var d=this.inputs.length;if(-1!==a){f.each(this.pickers,function(a,d){d.getUTCDate()||
d.setUTCDate(b)});if(b<this.dates[a])for(;0<=a&&b<this.dates[a];)this.pickers[a--].setUTCDate(b);else if(b>this.dates[a])for(;a<d&&b>this.dates[a];)this.pickers[a++].setUTCDate(b);this.updateDates();delete this.updating}}},remove:function(){f.map(this.pickers,function(a){a.remove()});delete this.element.data().datepicker}};var u=f.fn.datepicker;f.fn.datepicker=function(b){var d=Array.apply(null,arguments);d.shift();var g;this.each(function(){var k=f(this),l=k.data("datepicker"),m="object"===typeof b&&
b;if(!l){var l=a(this,"date"),t=f.extend({},v,l,m),t=h(t.language),m=f.extend({},v,t,l,m);k.is(".input-daterange")||m.inputs?(l={inputs:m.inputs||k.find("input").toArray()},k.data("datepicker",l=new r(this,f.extend(m,l)))):k.data("datepicker",l=new n(this,m))}if("string"===typeof b&&"function"===typeof l[b]&&(g=l[b].apply(l,d),g!==p))return!1});return g!==p?g:this};var v=f.fn.datepicker.defaults={autoclose:!1,beforeShowDay:f.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:Infinity,
forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},w=f.fn.datepicker.locale_opts=["format","rtl","weekStart"];f.fn.datepicker.Constructor=n;var l=f.fn.datepicker.dates={en:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),daysShort:"Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),daysMin:"Su Mo Tu We Th Fr Sa Su".split(" "),
months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),today:"Today",clear:"Clear"}},t={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(a){return 0===a%4&&0!==a%100||0===a%400},getDaysInMonth:function(a,b){return[31,t.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,
30,31][b]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(a){var b=a.replace(this.validParts,"\x00").split("\x00");a=a.match(this.validParts);if(!b||!b.length||!a||0===a.length)throw Error("Invalid date format.");return{separators:b,parts:a}},parseDate:function(a,b,d){function h(){var a=this.slice(0,m[u].length),b=m[u].slice(0,a.length);return a===b}if(!a)return p;if(a instanceof Date)return a;"string"===typeof b&&(b=t.parseFormat(b));
var g=/([\-+]\d+)([dmwy])/,m=a.match(/([\-+]\d+)([dmwy])/g),r,u;if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(a)){a=new Date;for(u=0;u<m.length;u++)switch(b=g.exec(m[u]),r=parseInt(b[1]),b[2]){case "d":a.setUTCDate(a.getUTCDate()+r);break;case "m":a=n.prototype.moveMonth.call(n.prototype,a,r);break;case "w":a.setUTCDate(a.getUTCDate()+7*r);break;case "y":a=n.prototype.moveYear.call(n.prototype,a,r)}return k(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),0,0,0)}m=a&&a.match(this.nonpunctuation)||
[];a=new Date;var g={},v="yyyy yy M MM m mm d dd".split(" ");r={yyyy:function(a,b){return a.setUTCFullYear(b)},yy:function(a,b){return a.setUTCFullYear(2E3+b)},m:function(a,b){if(isNaN(a))return a;for(--b;0>b;)b+=12;b%=12;for(a.setUTCMonth(b);a.getUTCMonth()!==b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}};var w;r.M=r.MM=r.mm=r.m;r.dd=r.d;a=k(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);var G=b.parts.slice();m.length!==G.length&&(G=f(G).filter(function(a,b){return-1!==
f.inArray(b,v)}).toArray());if(m.length===G.length){var y;u=0;for(y=G.length;u<y;u++){w=parseInt(m[u],10);b=G[u];if(isNaN(w))switch(b){case "MM":w=f(l[d].months).filter(h);w=f.inArray(w[0],l[d].months)+1;break;case "M":w=f(l[d].monthsShort).filter(h),w=f.inArray(w[0],l[d].monthsShort)+1}g[b]=w}for(u=0;u<v.length;u++)b=v[u],b in g&&!isNaN(g[b])&&(d=new Date(a),r[b](d,g[b]),isNaN(d)||(a=d))}return a},formatDate:function(a,b,d){if(!a)return"";"string"===typeof b&&(b=t.parseFormat(b));d={d:a.getUTCDate(),
D:l[d].daysShort[a.getUTCDay()],DD:l[d].days[a.getUTCDay()],m:a.getUTCMonth()+1,M:l[d].monthsShort[a.getUTCMonth()],MM:l[d].months[a.getUTCMonth()],yy:a.getUTCFullYear().toString().substring(2),yyyy:a.getUTCFullYear()};d.dd=(10>d.d?"0":"")+d.d;d.mm=(10>d.m?"0":"")+d.m;a=[];for(var h=f.extend([],b.separators),g=0,k=b.parts.length;g<=k;g++)h.length&&a.push(h.shift()),a.push(d[b.parts[g]]);return a.join("")},headTemplate:'<thead><tr><th class="prev">&laquo;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&raquo;</th></tr></thead>',
contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};t.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+t.headTemplate+"<tbody></tbody>"+t.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+t.headTemplate+t.contTemplate+t.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+
t.headTemplate+t.contTemplate+t.footTemplate+"</table></div></div>";f.fn.datepicker.DPGlobal=t;f.fn.datepicker.noConflict=function(){f.fn.datepicker=u;return this};f(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(a){var b=f(this);b.data("datepicker")||(a.preventDefault(),b.datepicker("show"))});f(function(){f('[data-provide="datepicker-inline"]').datepicker()})})(window.jQuery);
define("enketo-widget/date/bootstrap3-datepicker/js/bootstrap-datepicker",function(){});
define("enketo-widget/date/datepicker-extended",["enketo-js/Widget","enketo-js/support","jquery","enketo-widget/date/bootstrap3-datepicker/js/bootstrap-datepicker"],function(f,p,k){function g(d,a){this.namespace="datepickerExtended";f.call(this,d,a);this._init()}g.prototype=Object.create(f.prototype);g.prototype.constructor=g;g.prototype._init=function(){var d=this,a=k(this.element).parent("label"),f=a.hasClass("or-appearance-year")?{format:"yyyy",startView:"decade",minViewMode:"years"}:a.hasClass("or-appearance-month-year")?
{format:"yyyy-mm",startView:"year",minViewMode:"months"}:{format:"yyyy-mm-dd",startView:"month",minViewMode:"day"},a=this._createFakeDateInput(f.format);this._setManualHandler(a);this._setFocusHandler(a);this._setResetHandler(a);a.datepicker({format:f.format,autoclose:!0,todayHighlight:!0,startView:f.startView,minViewMode:f.minViewMode,orientation:"top"}).on("changeDate",function(){var a=k(this).val();"decade"===f.startView&&4===a.length?a+="-01-01":"year"===f.startView&&8>a.length&&(a+="-01");k(d.element).val(a).trigger("change").blur()})};
g.prototype._createFakeDateInput=function(d){var a=k(this.element);d=k('<div class="widget date"><input class="ignore input-small" readonly="readonly" type="text" value="'+a.val()+'" placeholder="'+d+'" /><button class="btn-icon-only btn-reset" type="button"><i class="icon icon-refresh"> </i></button></div>');var f=d.find("input");a.hide().after(d);return f};g.prototype._setManualHandler=function(d){};g.prototype._setResetHandler=function(d){d.next(".btn-reset").on("click",function(){d.val("").trigger("changeDate").datepicker("update")})};
g.prototype._setFocusHandler=function(d){var a=this;d.on("focus blur",function(d){k(a.element).trigger("fake"+d.type)})};k.fn.datepickerExtended=function(d,a){d=d||{};return this.each(function(){var f=k(this),m=f.data("datepickerExtended"),b=/GT-P31[0-9]{2}.+AppleWebKit\/534\.30/;if(!(m||"object"!==typeof d||d.touch&&p.inputtypes.date&&!b.test(navigator.userAgent)))f.data("datepickerExtended",new g(this,d,a));else if(m&&"string"===typeof d)m[d](this)})};return"datepickerExtended"});
define("text!enketo-widget/time/config.json",[],function(){return'{\n    "stylesheet": "timepicker-extended.scss",\n    "selector": "input[type=\\"time\\"]:not([readonly])",\n    "options": {}\n}\n'});
(function(f,p,k,g){var d=function(a,d){this.widget="";this.$element=f(a);this.defaultTime=d.defaultTime;this.disableFocus=d.disableFocus;this.disableMousewheel=d.disableMousewheel;this.isOpen=d.isOpen;this.minuteStep=d.minuteStep;this.modalBackdrop=d.modalBackdrop;this.orientation=d.orientation;this.secondStep=d.secondStep;this.showInputs=d.showInputs;this.showMeridian=d.showMeridian;this.showSeconds=d.showSeconds;this.template=d.template;this.appendWidgetTo=d.appendWidgetTo;this.showWidgetOnAddonClick=
d.showWidgetOnAddonClick;this._init()};d.prototype={constructor:d,_init:function(){var a=this;if(this.showWidgetOnAddonClick&&(this.$element.parent().hasClass("input-group")||this.$element.parent().hasClass("input-prepend")))this.$element.parent(".input-group, .input-prepend").find(".input-group-addon").on({"click.timepicker":f.proxy(this.showWidget,this)}),this.$element.on({"focus.timepicker":f.proxy(this.highlightUnit,this),"click.timepicker":f.proxy(this.highlightUnit,this),"keydown.timepicker":f.proxy(this.elementKeydown,
this),"blur.timepicker":f.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":f.proxy(this.mousewheel,this)});else if(this.template)this.$element.on({"focus.timepicker":f.proxy(this.showWidget,this),"click.timepicker":f.proxy(this.showWidget,this),"blur.timepicker":f.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":f.proxy(this.mousewheel,this)});else this.$element.on({"focus.timepicker":f.proxy(this.highlightUnit,this),"click.timepicker":f.proxy(this.highlightUnit,
this),"keydown.timepicker":f.proxy(this.elementKeydown,this),"blur.timepicker":f.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":f.proxy(this.mousewheel,this)});this.$widget=!1!==this.template?f(this.getTemplate()).on("click",f.proxy(this.widgetClick,this)):!1;this.showInputs&&!1!==this.$widget&&this.$widget.find("input").each(function(){f(this).on({"click.timepicker":function(){f(this).select()},"keydown.timepicker":f.proxy(a.widgetKeydown,a),"keyup.timepicker":f.proxy(a.widgetKeyup,
a)})});this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=null;this.updateFromElementVal()},clear:function(){this.meridian=this.second=this.minute=this.hour="";this.$element.val("")},decrementHour:function(){if(this.showMeridian)if(1===this.hour)this.hour=12;else{if(12===this.hour)return this.hour--,this.toggleMeridian();if(0===this.hour)return this.hour=11,this.toggleMeridian();this.hour--}else 0>=this.hour?this.hour=23:this.hour--},decrementMinute:function(a){a=a?
this.minute-a:this.minute-this.minuteStep;0>a?(this.decrementHour(),this.minute=a+60):this.minute=a},decrementSecond:function(){var a=this.second-this.secondStep;0>a?(this.decrementMinute(!0),this.second=a+60):this.second=a},elementKeydown:function(a){switch(a.keyCode){case 9:case 27:this.updateFromElementVal();break;case 37:a.preventDefault();this.highlightPrevUnit();break;case 38:a.preventDefault();switch(this.highlightedUnit){case "hour":this.incrementHour();this.highlightHour();break;case "minute":this.incrementMinute();
this.highlightMinute();break;case "second":this.incrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian(),this.highlightMeridian()}this.update();break;case 39:a.preventDefault();this.highlightNextUnit();break;case 40:a.preventDefault();switch(this.highlightedUnit){case "hour":this.decrementHour();this.highlightHour();break;case "minute":this.decrementMinute();this.highlightMinute();break;case "second":this.decrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian(),
this.highlightMeridian()}this.update()}},getCursorPosition:function(){var a=this.$element.get(0);if("selectionStart"in a)return a.selectionStart;if(k.selection){a.focus();var d=k.selection.createRange(),f=k.selection.createRange().text.length;d.moveStart("character",-a.value.length);return d.text.length-f}},getTemplate:function(){var a,d,f,b,g;this.showInputs?(d='<input type="text" data-name="hour" class="bootstrap-timepicker-hour form-control" maxlength="2"/>',f='<input type="text" data-name="minute" class="bootstrap-timepicker-minute form-control" maxlength="2"/>',
b='<input type="text" data-name="second" class="bootstrap-timepicker-second form-control" maxlength="2"/>',g='<input type="text" data-name="meridian" class="bootstrap-timepicker-meridian form-control" maxlength="2"/>'):(d='<span class="bootstrap-timepicker-hour"></span>',f='<span class="bootstrap-timepicker-minute"></span>',b='<span class="bootstrap-timepicker-second"></span>',g='<span class="bootstrap-timepicker-meridian"></span>');d='<table><tr><td><a href="#" data-action="incrementHour"><i class="glyphicon glyphicon-chevron-up"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="glyphicon glyphicon-chevron-up"></i></a></td>'+
(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="glyphicon glyphicon-chevron-up"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="glyphicon glyphicon-chevron-up"></i></a></td>':"")+"</tr><tr><td>"+d+'</td> <td class="separator">:</td><td>'+f+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+b+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+
g+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="glyphicon glyphicon-chevron-down"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="glyphicon glyphicon-chevron-down"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="glyphicon glyphicon-chevron-down"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="glyphicon glyphicon-chevron-down"></i></a></td>':
"")+"</tr></table>";switch(this.template){case "modal":a='<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">\u00d7</a><h3>Pick a Time</h3></div><div class="modal-content">'+d+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case "dropdown":a='<div class="bootstrap-timepicker-widget dropdown-menu">'+
d+"</div>"}return a},getTime:function(){return""===this.hour?"":this.hour+":"+(1===this.minute.toString().length?"0"+this.minute:this.minute)+(this.showSeconds?":"+(1===this.second.toString().length?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},hideWidget:function(){!1!==this.isOpen&&(this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),"modal"===this.template&&this.$widget.modal?
this.$widget.modal("hide"):this.$widget.removeClass("open"),f(k).off("mousedown.timepicker, touchend.timepicker"),this.isOpen=!1,this.$widget.detach())},highlightUnit:function(){this.position=this.getCursorPosition();0<=this.position&&2>=this.position?this.highlightHour():3<=this.position&&5>=this.position?this.highlightMinute():6<=this.position&&8>=this.position?this.showSeconds?this.highlightSecond():this.highlightMeridian():9<=this.position&&11>=this.position&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case "hour":this.highlightMinute();
break;case "minute":this.showSeconds?this.highlightSecond():this.showMeridian?this.highlightMeridian():this.highlightHour();break;case "second":this.showMeridian?this.highlightMeridian():this.highlightHour();break;case "meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case "hour":this.showMeridian?this.highlightMeridian():this.showSeconds?this.highlightSecond():this.highlightMinute();break;case "minute":this.highlightHour();break;case "second":this.highlightMinute();
break;case "meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour:function(){var a=this.$element.get(0),d=this;this.highlightedUnit="hour";a.setSelectionRange&&setTimeout(function(){10>d.hour?a.setSelectionRange(0,1):a.setSelectionRange(0,2)},0)},highlightMinute:function(){var a=this.$element.get(0),d=this;this.highlightedUnit="minute";a.setSelectionRange&&setTimeout(function(){10>d.hour?a.setSelectionRange(2,4):a.setSelectionRange(3,5)},0)},highlightSecond:function(){var a=
this.$element.get(0),d=this;this.highlightedUnit="second";a.setSelectionRange&&setTimeout(function(){10>d.hour?a.setSelectionRange(5,7):a.setSelectionRange(6,8)},0)},highlightMeridian:function(){var a=this.$element.get(0),d=this;this.highlightedUnit="meridian";a.setSelectionRange&&(this.showSeconds?setTimeout(function(){10>d.hour?a.setSelectionRange(8,10):a.setSelectionRange(9,11)},0):setTimeout(function(){10>d.hour?a.setSelectionRange(5,7):a.setSelectionRange(6,8)},0))},incrementHour:function(){if(this.showMeridian){if(11===
this.hour)return this.hour++,this.toggleMeridian();12===this.hour&&(this.hour=0)}23===this.hour?this.hour=0:this.hour++},incrementMinute:function(a){a=a?this.minute+a:this.minute+this.minuteStep-this.minute%this.minuteStep;59<a?(this.incrementHour(),this.minute=a-60):this.minute=a},incrementSecond:function(){var a=this.second+this.secondStep-this.second%this.secondStep;59<a?(this.incrementMinute(!0),this.second=a-60):this.second=a},mousewheel:function(a){if(!this.disableMousewheel){a.preventDefault();
a.stopPropagation();var d=a.originalEvent.wheelDelta||-a.originalEvent.detail,g=null;"mousewheel"===a.type?g=-1*a.originalEvent.wheelDelta:"DOMMouseScroll"===a.type&&(g=40*a.originalEvent.detail);g&&(a.preventDefault(),f(this).scrollTop(g+f(this).scrollTop()));switch(this.highlightedUnit){case "minute":0<d?this.incrementMinute():this.decrementMinute();this.highlightMinute();break;case "second":0<d?this.incrementSecond():this.decrementSecond();this.highlightSecond();break;case "meridian":this.toggleMeridian();
this.highlightMeridian();break;default:0<d?this.incrementHour():this.decrementHour(),this.highlightHour()}return!1}},place:function(){if(!this.isInline){var a=this.$widget.outerWidth(),d=this.$widget.outerHeight(),g=f(p).width(),b=f(p).height(),k=f(p).scrollTop(),r=parseInt(this.$element.parents().filter(function(){}).first().css("z-index"),10)+10,u=this.component?this.component.parent().offset():this.$element.offset(),v=this.component?this.component.outerHeight(!0):this.$element.outerHeight(!1),
w=this.component?this.component.outerWidth(!0):this.$element.outerWidth(!1),l=u.left,t=u.top;this.$widget.removeClass("timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left");"auto"!==this.orientation.x?(this.picker.addClass("datepicker-orient-"+this.orientation.x),"right"===this.orientation.x&&(l-=a-w)):(this.$widget.addClass("timepicker-orient-left"),0>u.left?l-=u.left-10:u.left+a>g&&(l=g-a-10));a=this.orientation.y;"auto"===a&&(a=-k+u.top-d,b=k+b-(u.top+
v+d),a=Math.max(a,b)===b?"top":"bottom");this.$widget.addClass("timepicker-orient-"+a);t="top"===a?t+v:t-(d+parseInt(this.$widget.css("padding-top"),10));this.$widget.css({top:t,left:l,zIndex:r})}},remove:function(){f("document").off(".timepicker");this.$widget&&this.$widget.remove();delete this.$element.data().timepicker},setDefaultTime:function(a){if(this.$element.val())this.updateFromElementVal();else if("current"===a){a=new Date;var d=a.getHours(),f=a.getMinutes(),b=a.getSeconds(),g="AM";0!==
b&&(b=Math.ceil(a.getSeconds()/this.secondStep)*this.secondStep,60===b&&(f+=1,b=0));0!==f&&(f=Math.ceil(a.getMinutes()/this.minuteStep)*this.minuteStep,60===f&&(d+=1,f=0));this.showMeridian&&(0===d?d=12:12<=d?(12<d&&(d-=12),g="PM"):g="AM");this.hour=d;this.minute=f;this.second=b;this.meridian=g;this.update()}else!1===a?(this.second=this.minute=this.hour=0,this.meridian="AM"):this.setTime(a)},setTime:function(a,d){if(a){var f,b,g,k;"object"===typeof a&&a.getMonth?(b=a.getHours(),g=a.getMinutes(),f=
a.getSeconds(),this.showMeridian&&(k="AM",12<b&&(k="PM",b%=12),12===b&&(k="PM"))):(k=null!==a.match(/p/i)?"PM":"AM",a=a.replace(/[^0-9\:]/g,""),f=a.split(":"),b=f[0]?f[0].toString():f.toString(),g=f[1]?f[1].toString():"",f=f[2]?f[2].toString():"",4<b.length&&(f=b.substr(4,2)),2<b.length&&(g=b.substr(2,2),b=b.substr(0,2)),2<g.length&&(f=g.substr(2,2),g=g.substr(0,2)),2<f.length&&(f=f.substr(2,2)),b=parseInt(b,10),g=parseInt(g,10),f=parseInt(f,10),isNaN(b)&&(b=0),isNaN(g)&&(g=0),isNaN(f)&&(f=0),this.showMeridian?
1>b?b=1:12<b&&(b=12):(24<=b?b=23:0>b&&(b=0),13>b&&"PM"===k&&(b+=12)),0>g?g=0:60<=g&&(g=59),this.showSeconds&&(isNaN(f)?f=0:0>f?f=0:60<=f&&(f=59)));this.hour=b;this.minute=g;this.second=f;this.meridian=k;this.update(d)}else this.clear()},showWidget:function(){if(!this.isOpen&&!this.$element.is(":disabled")){this.$widget.appendTo(this.appendWidgetTo);var a=this;f(k).on("mousedown.timepicker, touchend.timepicker",function(d){a.$element.parent().find(d.target).length||a.$widget.is(d.target)||a.$widget.find(d.target).length||
a.hideWidget()});this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});this.place();this.disableFocus&&this.$element.blur();""===this.hour&&(this.defaultTime?this.setDefaultTime(this.defaultTime):this.setTime("0:0:0"));if("modal"===this.template&&this.$widget.modal)this.$widget.modal("show").on("hidden",f.proxy(this.hideWidget,this));else!1===this.isOpen&&this.$widget.addClass("open");this.isOpen=
!0}},toggleMeridian:function(){this.meridian="AM"===this.meridian?"PM":"AM"},update:function(a){this.updateElement();a||this.updateWidget();this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){this.setTime(this.$element.val())},updateWidget:function(){if(!1!==this.$widget){var a=this.hour,d=
1===this.minute.toString().length?"0"+this.minute:this.minute,f=1===this.second.toString().length?"0"+this.second:this.second;this.showInputs?(this.$widget.find("input.bootstrap-timepicker-hour").val(a),this.$widget.find("input.bootstrap-timepicker-minute").val(d),this.showSeconds&&this.$widget.find("input.bootstrap-timepicker-second").val(f),this.showMeridian&&this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)):(this.$widget.find("span.bootstrap-timepicker-hour").text(a),
this.$widget.find("span.bootstrap-timepicker-minute").text(d),this.showSeconds&&this.$widget.find("span.bootstrap-timepicker-second").text(f),this.showMeridian&&this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian))}},updateFromWidgetInputs:function(){if(!1!==this.$widget){var a=this.$widget.find("input.bootstrap-timepicker-hour").val()+":"+this.$widget.find("input.bootstrap-timepicker-minute").val()+(this.showSeconds?":"+this.$widget.find("input.bootstrap-timepicker-second").val():
"")+(this.showMeridian?this.$widget.find("input.bootstrap-timepicker-meridian").val():"");this.setTime(a,!0)}},widgetClick:function(a){a.stopPropagation();a.preventDefault();a=f(a.target);var d=a.closest("a").data("action");if(d)this[d]();this.update();a.is("input")&&a.get(0).setSelectionRange(0,2)},widgetKeydown:function(a){var d=f(a.target),g=d.data("name");switch(a.keyCode){case 9:if(this.showMeridian&&"meridian"===g||this.showSeconds&&"second"===g||!this.showMeridian&&!this.showSeconds&&"minute"===
g)return this.hideWidget();break;case 27:this.hideWidget();break;case 38:a.preventDefault();switch(g){case "hour":this.incrementHour();break;case "minute":this.incrementMinute();break;case "second":this.incrementSecond();break;case "meridian":this.toggleMeridian()}this.setTime(this.getTime());d.get(0).setSelectionRange(0,2);break;case 40:a.preventDefault();switch(g){case "hour":this.decrementHour();break;case "minute":this.decrementMinute();break;case "second":this.decrementSecond();break;case "meridian":this.toggleMeridian()}this.setTime(this.getTime());
d.get(0).setSelectionRange(0,2)}},widgetKeyup:function(a){(65===a.keyCode||77===a.keyCode||80===a.keyCode||46===a.keyCode||8===a.keyCode||46<=a.keyCode&&57>=a.keyCode)&&this.updateFromWidgetInputs()}};f.fn.timepicker=function(a){var g=Array.apply(null,arguments);g.shift();return this.each(function(){var k=f(this),b=k.data("timepicker"),n="object"===typeof a&&a;b||k.data("timepicker",b=new d(this,f.extend({},f.fn.timepicker.defaults,n,f(this).data())));"string"===typeof a&&b[a].apply(b,g)})};f.fn.timepicker.defaults=
{defaultTime:"current",disableFocus:!1,disableMousewheel:!1,isOpen:!1,minuteStep:15,modalBackdrop:!1,orientation:{x:"auto",y:"auto"},secondStep:15,showSeconds:!1,showInputs:!0,showMeridian:!0,template:"dropdown",appendWidgetTo:"body",showWidgetOnAddonClick:!0};f.fn.timepicker.Constructor=d})(jQuery,window,document);define("enketo-widget/time/bootstrap3-timepicker/js/bootstrap-timepicker",function(){});
define("enketo-widget/time/timepicker-extended",["enketo-js/Widget","enketo-js/support","jquery","enketo-widget/time/bootstrap3-timepicker/js/bootstrap-timepicker"],function(f,p,k){function g(d,a){this.namespace="timepickerExtended";f.call(this,d,a);this._init()}g.prototype=Object.create(f.prototype);g.prototype.constructor=g;g.prototype._init=function(){var d=k(this.element),a=k(this.element).val(),f=k('<div class="widget bootstrap-timepicker"><input class="ignore timepicker-default input-small" readonly="readonly" type="text" value="'+
a+'" placeholder="hh:mm" /><button class="btn-icon-only btn-reset" type="button"><i class="icon icon-refresh"> </i></button></div>'),g=f.find(".btn-reset"),b=f.find("input");d.next(".widget.bootstrap-timepicker-component").remove();d.hide().after(f);b.timepicker({defaultTime:0<a.length?a:"current",showMeridian:!1}).val(a).closest(".widget").find("input").addClass("ignore");b.on("change",function(){var a=k(this),a=/^[0-9]:/.test(a.val())?"0"+a.val():a.val(),a=/^[0-9]{2}:$/.test(a)?a+"00":a;d.val(a).trigger("change").blur();
return!1});g.on("click",function(){b.val("").trigger("change")});b.on("focus blur",function(a){d.trigger("fake"+a.type)})};k.fn.timepickerExtended=function(d,a){d=d||{};return this.each(function(){var f=k(this),m=f.data("timepickerExtended");if(!(m||"object"!==typeof d||d.touch&&p.inputtypes.time))f.data("timepickerExtended",new g(this,d,a));else if(m&&"string"===typeof d)m[d](this)})};return"timepickerExtended"});define("text!enketo-widget/datetime/config.json",[],function(){return'{\n    "stylesheet": "datetimepicker-extended.scss",\n    "selector": "input[type=\\"datetime\\"]:not([readonly])",\n    "options": {}\n}\n'});
define("enketo-widget/datetime/datetimepicker-extended","enketo-js/Widget enketo-js/support jquery enketo-js/extend enketo-widget/date/bootstrap3-datepicker/js/bootstrap-datepicker enketo-widget/time/bootstrap3-timepicker/js/bootstrap-timepicker".split(" "),function(f,p,k){function g(d,a){this.namespace="datetimepickerExtended";f.call(this,d,a);this._init()}g.prototype=Object.create(f.prototype);g.prototype.constructor=g;g.prototype._init=function(){function d(){if(0<b.val().length&&0<n.val().length){var d=
b.val().split("-"),f=n.val().split(":");a.val((new Date(d[0],d[1]-1,d[2],f[0],f[1])).toISOLocalString()).trigger("change").blur()}else a.val("").trigger("change").blur()}var a=k(this.element),f=(0<a.val().length?(new Date(a.val())).toISOLocalString():"").split("T"),g=f[0],f=f[1]&&4<f[1].length?f[1].substring(0,5):"",b=this._createFakeDateInput(g),n=this._createFakeTimeInput(f);a.hide().after('<div class="datetimepicker widget" />');a.siblings(".datetimepicker").append(b.closest(".date")).append(n.closest(".bootstrap-timepicker"));
b.datepicker({format:"yyyy-mm-dd",autoclose:!0,todayHighlight:!0});n.timepicker({defaultTime:0<f.length?"value":"current",showMeridian:!1}).val(f).closest(".widget").find("input").addClass("ignore");this._setManualHandler(b);this._setFocusHandler(b.add(n));b.on("change changeDate",function(){d();return!1});n.on("change",function(){d();return!1});n.next(".btn-reset").on("click",function(){b.val("").trigger("change").datepicker("update");n.val("").trigger("change")})};g.prototype._createFakeDateInput=
function(d){return k('<div class="date"><input class="ignore input-small" type="text" readonly="readonly" value="'+d+'" placeholder="yyyy-mm-dd"/></div>').find("input")};g.prototype._createFakeTimeInput=function(d){return k('<div class="bootstrap-timepicker"><input class="ignore timepicker-default input-small" readonly="readonly" type="text" value="'+d+'" placeholder="hh:mm"/><button class="btn-icon-only btn-reset" type="button"><i class="icon icon-refresh"> </i></button></div>').find("input")};g.prototype._setManualHandler=
function(){};g.prototype._setFocusHandler=function(d){var a=this;d.on("focus blur",function(d){k(a.element).trigger("fake"+d.type)})};k.fn.datetimepickerExtended=function(d,a){d=d||{};return this.each(function(){var f=k(this),m=f.data("datetimepickerExtended"),b=/GT-P31[0-9]{2}.+AppleWebKit\/534\.30/;if(!(m||"object"!==typeof d||d.touch&&p.inputtypes.datetime&&!b.test(navigator.userAgent)))f.data("datetimepickerExtended",new g(this,d,a));else if(m&&"string"===typeof d)m[d](this)})};return"datetimepickerExtended"});
define("text!enketo-widget/mediagrid/config.json",[],function(){return'{\n    "stylesheet": "mediagridpicker.scss",\n    "selector": null,\n    "options": {}\n}\n'});define("enketo-widget/mediagrid/mediagridpicker",function(){});define("text!enketo-widget/select-likert/config.json",[],function(){return'{\n    "stylesheet": "likertitem.scss",\n    "selector": null,\n    "options": {}\n}\n'});define("enketo-widget/select-likert/likertitem",function(){});
